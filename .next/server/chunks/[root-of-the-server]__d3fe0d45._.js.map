{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/backend/db.js"],"sourcesContent":["\nimport mysql from 'mysql2/promise';\nimport dotenv from 'dotenv';\nimport path from 'path';\nimport fs from 'fs';\nimport { fileURLToPath } from 'url';\n\n// Get the directory name in ES module scope\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Construct absolute path to .env file in the parent directory\nconst envPath = path.resolve(__dirname, \".env\");\ndotenv.config({ path: envPath });\n\n// Construct absolute path to ca.pem file in the same directory\nconst caPath = path.resolve(__dirname, \"ca.pem\");\nlet caCert;\n\ntry {\n  if (!fs.existsSync(caPath)) {\n    console.error(`CRITICAL_DB_INIT_ERROR: CA certificate file (ca.pem) not found at expected location: ${caPath}. Database connections requiring SSL will likely fail. Please ensure 'backend/ca.pem' exists.`);\n    // caCert will remain undefined. mysql.createPool might fail if SSL is strictly required.\n  } else {\n    caCert = fs.readFileSync(caPath, 'utf8');\n  }\n} catch (e) {\n  console.error(`CRITICAL_DB_INIT_ERROR: Error reading CA certificate file (ca.pem) at ${caPath}: ${e.message}. Database connections may fail.`);\n  // Depending on the error, caCert might be undefined or an error could be thrown, halting further execution.\n  // For robustness, we could choose to throw here to make the failure explicit.\n  // throw new Error(`Failed to read ca.pem: ${e.message}`);\n}\n\n// Check for essential DB environment variables\nconst essentialEnvVars = ['DB_HOST', 'DB_USER', 'DB_PASSWORD', 'DB_NAME'];\nconst missingEnvVars = essentialEnvVars.filter(v => !process.env[v]);\n\nif (missingEnvVars.length > 0) {\n    console.error(`CRITICAL_DB_INIT_ERROR: Missing essential database environment variables: ${missingEnvVars.join(', ')}. These should be defined in backend/.env for local development or configured in your hosting environment. Database connections will fail.`);\n    // To make the server fail fast and clearly, throwing an error here is a good practice.\n    // This prevents a more obscure \"Internal Server Error\" later.\n    throw new Error(`Missing critical DB environment variables: ${missingEnvVars.join(', ')}. Check your backend/.env file or hosting configuration.`);\n}\n\nlet pool;\ntry {\n  pool = mysql.createPool({\n    host: process.env.DB_HOST,\n    user: process.env.DB_USER,\n    password: process.env.DB_PASSWORD,\n    database: process.env.DB_NAME,\n    port: process.env.DB_PORT ? parseInt(process.env.DB_PORT, 10) : 3306,\n    ssl: {\n      ca: caCert, // If caCert is undefined due to file not found, this may cause issues\n      rejectUnauthorized: true, // Recommended for production if using a trusted CA\n    },\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0,\n  });\n  console.log(\"DB_INIT_SUCCESS: MySQL connection pool created (this does not guarantee successful connection yet, but configuration is loaded).\");\n} catch (error) {\n  console.error(`CRITICAL_DB_INIT_ERROR: Failed to create MySQL connection pool: ${error.message}. This is a fatal error for database operations.`);\n  // Re-throwing the error here will make the application fail on startup if the pool cannot be initialized,\n  // which is often better than encountering errors later during request handling.\n  throw new Error(`Failed to initialize database connection pool due to: ${error.message}. Review DB configuration (backend/.env) and SSL certificate (backend/ca.pem).`);\n}\n\n// Export the connection pool\nexport {pool};\n"],"names":[],"mappings":";;;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEA,4CAA4C;AAC5C,MAAM,aAAa,CAAA,GAAA,+FAAA,CAAA,gBAAa,AAAD,EAAE,8BAAY,GAAG;AAChD,MAAM,YAAY,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC;AAE/B,+DAA+D;AAC/D,MAAM,UAAU,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC,WAAW;AACxC,uIAAA,CAAA,UAAM,CAAC,MAAM,CAAC;IAAE,MAAM;AAAQ;AAE9B,+DAA+D;AAC/D,MAAM,SAAS,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC,WAAW;AACvC,IAAI;AAEJ,IAAI;IACF,IAAI,CAAC,6FAAA,CAAA,UAAE,CAAC,UAAU,CAAC,SAAS;QAC1B,QAAQ,KAAK,CAAC,CAAC,qFAAqF,EAAE,OAAO,6FAA6F,CAAC;IAC3M,yFAAyF;IAC3F,OAAO;QACL,SAAS,6FAAA,CAAA,UAAE,CAAC,YAAY,CAAC,QAAQ;IACnC;AACF,EAAE,OAAO,GAAG;IACV,QAAQ,KAAK,CAAC,CAAC,sEAAsE,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,CAAC,gCAAgC,CAAC;AAC7I,4GAA4G;AAC5G,8EAA8E;AAC9E,0DAA0D;AAC5D;AAEA,+CAA+C;AAC/C,MAAM,mBAAmB;IAAC;IAAW;IAAW;IAAe;CAAU;AACzE,MAAM,iBAAiB,iBAAiB,MAAM,CAAC,CAAA,IAAK,CAAC,QAAQ,GAAG,CAAC,EAAE;AAEnE,IAAI,eAAe,MAAM,GAAG,GAAG;IAC3B,QAAQ,KAAK,CAAC,CAAC,0EAA0E,EAAE,eAAe,IAAI,CAAC,MAAM,0IAA0I,CAAC;IAChQ,uFAAuF;IACvF,8DAA8D;IAC9D,MAAM,IAAI,MAAM,CAAC,2CAA2C,EAAE,eAAe,IAAI,CAAC,MAAM,wDAAwD,CAAC;AACrJ;AAEA,IAAI;AACJ,IAAI;IACF,OAAO,mIAAA,CAAA,UAAK,CAAC,UAAU,CAAC;QACtB,MAAM,QAAQ,GAAG,CAAC,OAAO;QACzB,MAAM,QAAQ,GAAG,CAAC,OAAO;QACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;QACjC,UAAU,QAAQ,GAAG,CAAC,OAAO;QAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,GAAG,SAAS,QAAQ,GAAG,CAAC,OAAO,EAAE,MAAM;QAChE,KAAK;YACH,IAAI;YACJ,oBAAoB;QACtB;QACA,oBAAoB;QACpB,iBAAiB;QACjB,YAAY;IACd;IACA,QAAQ,GAAG,CAAC;AACd,EAAE,OAAO,OAAO;IACd,QAAQ,KAAK,CAAC,CAAC,gEAAgE,EAAE,MAAM,OAAO,CAAC,gDAAgD,CAAC;IAChJ,0GAA0G;IAC1G,gFAAgF;IAChF,MAAM,IAAI,MAAM,CAAC,sDAAsD,EAAE,MAAM,OAAO,CAAC,8EAA8E,CAAC;AACxK","debugId":null}},
    {"offset": {"line": 268, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/api/purchase-orders/route.js"],"sourcesContent":["\n\nimport { pool } from '../../../../backend/db.js';\nimport { NextResponse } from 'next/server';\nimport csv from 'csv-parser';\nimport { Readable } from 'stream';\n\nexport async function GET(request) {\n  const { searchParams } = new URL(request.url);\n  const month = searchParams.get('month');\n  const year = searchParams.get('year');\n  const approverId = searchParams.get('approverId');\n  const creatorUserId = searchParams.get('creatorUserId'); \n  const status = searchParams.get('status');\n  // const overallSiteId = searchParams.get('siteId'); // Overall PO siteId filter removed\n\n  let query = `\n    SELECT\n        po.id, po.poNumber, po.creationDate, po.status, po.subTotal, po.vatAmount,\n        po.grandTotal, po.currency, po.pricesIncludeVat, po.notes, po.requestedByName, \n        po.creatorUserId, po.approverId, po.siteId AS overallSiteId, \n        s.supplierName, app.name AS approverName, u.name AS creatorName,\n        overall_site.siteCode AS overallSiteName \n    FROM PurchaseOrder po\n    LEFT JOIN Supplier s ON po.supplierId = s.supplierCode\n    LEFT JOIN Approver app ON po.approverId = app.id\n    LEFT JOIN User u ON po.creatorUserId = u.id\n    LEFT JOIN Site overall_site ON po.siteId = overall_site.id \n    WHERE 1=1\n  `;\n  const queryParams = [];\n\n  if (month && month !== 'all') {\n    query += ' AND MONTH(po.creationDate) = ?';\n    queryParams.push(parseInt(month, 10));\n  }\n  if (year && year !== 'all') {\n    query += ' AND YEAR(po.creationDate) = ?';\n    queryParams.push(parseInt(year, 10));\n  }\n  if (approverId && approverId !== 'all') {\n    query += ' AND po.approverId = ?';\n    queryParams.push(approverId);\n  }\n  if (creatorUserId && creatorUserId !== 'all') {\n    query += ' AND po.creatorUserId = ?';\n    queryParams.push(creatorUserId);\n  }\n  if (status && status !== 'all') {\n    query += ' AND po.status = ?';\n    queryParams.push(status);\n  }\n  // Overall PO siteId filter is removed as the field is removed from the form\n  // if (overallSiteId && overallSiteId !== 'all') { \n  //   query += ' AND po.siteId = ?';\n  //   queryParams.push(parseInt(overallSiteId, 10));\n  // }\n\n\n  query += ' ORDER BY po.creationDate DESC';\n\n  try {\n    const [rows] = await pool.execute(query, queryParams);\n    return NextResponse.json(rows);\n  } catch (error) {\n    console.error('[API_ERROR] /api/purchase-orders GET: Error fetching purchase orders:', error);\n    return NextResponse.json({ error: 'Failed to fetch purchase orders', details: error.message }, { status: 500 });\n  }\n}\n\nexport async function POST(request) {\n  const contentType = request.headers.get('content-type');\n\n  if (contentType && contentType.includes('application/json')) {\n    console.log('[API_INFO] /api/purchase-orders POST: Received application/json request.');\n    let connection;\n    try {\n      const poData = await request.json();\n      const {\n        poNumber, creationDate, creatorUserId, requestedByName, supplierId,    \n        approverId, /* siteId, */ status, subTotal, vatAmount, grandTotal, currency, // siteId (overall PO siteId) removed\n        pricesIncludeVat, notes, items, selectedRequisitionId, // Added selectedRequisitionId\n      } = poData;\n\n      connection = await pool.getConnection();\n      await connection.beginTransaction();\n\n      const finalCreatorUserId = creatorUserId || null;\n      // const finalSiteId = siteId ? Number(siteId) : null; // Removed finalSiteId, PO header siteId will be NULL\n\n      const [poResult] = await connection.execute(\n        `INSERT INTO PurchaseOrder (poNumber, creationDate, creatorUserId, requestedByName, supplierId, approverId, siteId, status, subTotal, vatAmount, grandTotal, currency, pricesIncludeVat, notes)\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`, \n        [poNumber, new Date(creationDate), finalCreatorUserId, requestedByName, supplierId, approverId, null, status, subTotal, vatAmount, grandTotal, currency, pricesIncludeVat, notes] // siteId set to null\n      );\n\n      const newPoId = poResult.insertId;\n\n      if (items && items.length > 0) {\n        for (const item of items) {\n          await connection.execute(\n            `INSERT INTO POItem (poId, partNumber, description, categoryId, siteId, uom, quantity, unitPrice, quantityReceived, itemStatus)\n             VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`, \n            [newPoId, item.partNumber, item.description, item.categoryId, item.siteId || null, item.uom, Number(item.quantity), Number(item.unitPrice), item.quantityReceived || 0, item.itemStatus || 'Pending']\n          );\n        }\n      }\n\n      if (selectedRequisitionId) {\n        console.log(`[API_INFO] PO created from Requisition ID: ${selectedRequisitionId}. Attempting to update Requisition status.`);\n        const [updateReqResult] = await connection.execute(\n          'UPDATE Requisition SET status = ? WHERE id = ? AND status = ?',\n          ['Closed', selectedRequisitionId, 'Approved'] // Mark as 'Closed', ensure it was 'Approved'\n        );\n        if (updateReqResult.affectedRows > 0) {\n          console.log(`[API_INFO] Requisition ID ${selectedRequisitionId} status updated to 'Closed'.`);\n        } else {\n          console.warn(`[API_WARN] Failed to update Requisition ID ${selectedRequisitionId} status to 'Closed', or it was not in 'Approved' state.`);\n        }\n      }\n\n      await connection.commit();\n      return NextResponse.json({ message: 'Purchase order created successfully', poId: newPoId, poNumber: poNumber }, { status: 201 });\n\n    } catch (dbError) {\n      if (connection) {\n        await connection.rollback();\n      }\n      console.error('[API_ERROR] /api/purchase-orders POST JSON: Error creating purchase order:', dbError);\n      return NextResponse.json({ error: 'Failed to create purchase order due to a server error.', details: dbError.message }, { status: 500 });\n    } finally {\n      if (connection) {\n        connection.release();\n      }\n    }\n  } else if (contentType && contentType.includes('multipart/form-data')) {\n    console.log('[API_INFO] /api/purchase-orders POST: Received multipart/form-data request for CSV upload.');\n    let connection;\n    try {\n      const formData = await request.formData();\n      const file = formData.get('file');\n      \n      if (!file || typeof file === 'string') { \n        return NextResponse.json({ error: 'No file uploaded or invalid file type' }, { status: 400 });\n      }\n      \n      const fileBuffer = Buffer.from(await file.arrayBuffer());\n      const results = [];\n      const stream = Readable.from(fileBuffer);\n\n      await new Promise((resolve, reject) => {\n        stream\n          .pipe(csv({\n            mapHeaders: ({ header }) => header.trim().toLowerCase()\n          }))\n          .on('data', (data) => results.push(data))\n          .on('end', resolve)\n          .on('error', reject);\n      });\n\n      if (results.length === 0) {\n        return NextResponse.json({ message: 'Purchase Order CSV file is empty or could not be parsed.' }, { status: 400 });\n      }\n\n      const posGroupedByNumber = results.reduce((acc, row) => {\n        const poNumber = row.ponumber?.trim();\n        if (!poNumber) return acc;\n        if (!acc[poNumber]) acc[poNumber] = [];\n        acc[poNumber].push(row);\n        return acc;\n      }, {});\n\n      connection = await pool.getConnection();\n      \n      const [suppliers] = await connection.execute('SELECT supplierCode FROM Supplier');\n      const [approvers] = await connection.execute('SELECT id FROM Approver');\n      const [categories] = await connection.execute('SELECT id FROM Category');\n      const [sites] = await connection.execute('SELECT id FROM Site');\n\n      const supplierSet = new Set(suppliers.map(s => s.supplierCode));\n      const approverSet = new Set(approvers.map(a => a.id));\n      const categorySet = new Set(categories.map(c => c.id));\n      const siteSet = new Set(sites.map(s => s.id));\n\n      let successfulImports = 0;\n      let failedImports = 0;\n      const errors = [];\n\n      await connection.beginTransaction();\n\n      for (const poNumber in posGroupedByNumber) {\n        const poItems = posGroupedByNumber[poNumber];\n        const headerRow = poItems[0];\n\n        try {\n          const supplierCode = headerRow.suppliercode?.trim();\n          const approverId = headerRow.approverid?.trim();\n          const poDate = headerRow.podate?.trim();\n          const notes = headerRow.overallnotes?.trim();\n          const pricesIncludeVatValue = String(headerRow.pricesincludevat || '0').toLowerCase().trim();\n\n          if (!supplierSet.has(supplierCode)) {\n            throw new Error(`Supplier Code '${supplierCode}' does not exist.`);\n          }\n          if (approverId && !approverSet.has(approverId)) {\n            throw new Error(`Approver ID '${approverId}' does not exist.`);\n          }\n          \n          let subTotal = 0;\n          for (const item of poItems) {\n            const qty = parseFloat(item.itemquantity?.trim());\n            const price = parseFloat(item.itemunitprice?.trim());\n            if (isNaN(qty) || isNaN(price)) {\n              throw new Error(`Invalid quantity or unit price for an item in PO ${poNumber}.`);\n            }\n            subTotal += qty * price;\n          }\n\n          const pricesIncludeVat = ['true', '1', 'yes'].includes(pricesIncludeVatValue);\n          let vatAmount = 0;\n          if (headerRow.currency?.trim() === 'MZN' && !pricesIncludeVat) {\n              vatAmount = subTotal * 0.16;\n          }\n          const grandTotal = subTotal + vatAmount;\n\n          const poInsertQuery = `\n            INSERT INTO PurchaseOrder (poNumber, creationDate, creatorUserId, requestedByName, supplierId, approverId, siteId, status, subTotal, vatAmount, grandTotal, currency, pricesIncludeVat, notes)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n          `;\n          const [poResult] = await connection.execute(poInsertQuery, [\n            poNumber,\n            poDate ? new Date(poDate) : new Date(),\n            null,\n            headerRow.requestedbyname?.trim() || null,\n            supplierCode || null,\n            approverId || null,\n            null,\n            headerRow.status?.trim() || 'Approved',\n            subTotal, vatAmount, grandTotal,\n            headerRow.currency?.trim() || 'MZN',\n            pricesIncludeVat,\n            notes || null,\n          ]);\n          const newPoId = poResult.insertId;\n\n          for (const item of poItems) {\n            const categoryId = item.itemcategoryid ? parseInt(item.itemcategoryid.trim(), 10) : null;\n            const siteId = item.itemsiteid ? parseInt(item.itemsiteid.trim(), 10) : null;\n            \n            if (categoryId && !categorySet.has(categoryId)) {\n                throw new Error(`Item in PO ${poNumber} has an invalid Category ID: ${categoryId}`);\n            }\n            if (siteId && !siteSet.has(siteId)) {\n                throw new Error(`Item in PO ${poNumber} has an invalid Site ID: ${siteId}`);\n            }\n\n            const itemInsertQuery = `\n              INSERT INTO POItem (poId, partNumber, description, categoryId, siteId, uom, quantity, unitPrice)\n              VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n            `;\n            await connection.execute(itemInsertQuery, [\n              newPoId,\n              item.itempartnumber?.trim() || null,\n              item.itemdescription?.trim() || 'N/A',\n              categoryId, siteId,\n              item.itemuom?.trim() || 'EA',\n              parseFloat(item.itemquantity?.trim()) || 0,\n              parseFloat(item.itemunitprice?.trim()) || 0,\n            ]);\n          }\n          successfulImports++;\n        } catch (error) {\n          failedImports++;\n          errors.push(`Failed to import PO ${poNumber}: ${error.message}`);\n        }\n      }\n\n      if (failedImports > 0) {\n        await connection.rollback();\n        console.warn(`[API_WARN] PO CSV Upload: Rolled back transaction due to ${failedImports} errors.`, errors);\n        return NextResponse.json({\n            message: `Processing complete. ${successfulImports} POs were valid but the transaction was rolled back due to ${failedImports} errors. Please fix the CSV and re-upload.`,\n            errors: errors\n        }, { status: 400 });\n      } else {\n        await connection.commit();\n        console.log(`[API_INFO] PO CSV Upload: Transaction committed successfully for ${successfulImports} POs.`);\n        return NextResponse.json({\n            message: `Successfully imported ${successfulImports} Purchase Orders and their items into the database.`,\n        }, { status: 200 });\n      }\n    } catch (error) {\n      if (connection) await connection.rollback();\n      console.error('[API_ERROR] /api/purchase-orders POST CSV: Error handling purchase order file upload:', error);\n      return NextResponse.json({ error: 'Failed to handle purchase order file upload', details: error.message }, { status: 500 });\n    } finally {\n      if (connection) connection.release();\n    }\n  } else {\n    console.warn(`[API_WARN] /api/purchase-orders POST: Unsupported Content-Type: ${contentType}`);\n    return NextResponse.json({ error: 'Unsupported Content-Type' }, { status: 415 });\n  }\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;;;AAEO,eAAe,IAAI,OAAO;IAC/B,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,QAAQ,aAAa,GAAG,CAAC;IAC/B,MAAM,OAAO,aAAa,GAAG,CAAC;IAC9B,MAAM,aAAa,aAAa,GAAG,CAAC;IACpC,MAAM,gBAAgB,aAAa,GAAG,CAAC;IACvC,MAAM,SAAS,aAAa,GAAG,CAAC;IAChC,wFAAwF;IAExF,IAAI,QAAQ,CAAC;;;;;;;;;;;;;EAab,CAAC;IACD,MAAM,cAAc,EAAE;IAEtB,IAAI,SAAS,UAAU,OAAO;QAC5B,SAAS;QACT,YAAY,IAAI,CAAC,SAAS,OAAO;IACnC;IACA,IAAI,QAAQ,SAAS,OAAO;QAC1B,SAAS;QACT,YAAY,IAAI,CAAC,SAAS,MAAM;IAClC;IACA,IAAI,cAAc,eAAe,OAAO;QACtC,SAAS;QACT,YAAY,IAAI,CAAC;IACnB;IACA,IAAI,iBAAiB,kBAAkB,OAAO;QAC5C,SAAS;QACT,YAAY,IAAI,CAAC;IACnB;IACA,IAAI,UAAU,WAAW,OAAO;QAC9B,SAAS;QACT,YAAY,IAAI,CAAC;IACnB;IACA,4EAA4E;IAC5E,mDAAmD;IACnD,mCAAmC;IACnC,mDAAmD;IACnD,IAAI;IAGJ,SAAS;IAET,IAAI;QACF,MAAM,CAAC,KAAK,GAAG,MAAM,+GAAA,CAAA,OAAI,CAAC,OAAO,CAAC,OAAO;QACzC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yEAAyE;QACvF,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;YAAmC,SAAS,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC/G;AACF;AAEO,eAAe,KAAK,OAAO;IAChC,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC;IAExC,IAAI,eAAe,YAAY,QAAQ,CAAC,qBAAqB;QAC3D,QAAQ,GAAG,CAAC;QACZ,IAAI;QACJ,IAAI;YACF,MAAM,SAAS,MAAM,QAAQ,IAAI;YACjC,MAAM,EACJ,QAAQ,EAAE,YAAY,EAAE,aAAa,EAAE,eAAe,EAAE,UAAU,EAClE,UAAU,EAAE,WAAW,GAAG,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,EAAE,QAAQ,EAC3E,gBAAgB,EAAE,KAAK,EAAE,KAAK,EAAE,qBAAqB,EACtD,GAAG;YAEJ,aAAa,MAAM,+GAAA,CAAA,OAAI,CAAC,aAAa;YACrC,MAAM,WAAW,gBAAgB;YAEjC,MAAM,qBAAqB,iBAAiB;YAC5C,4GAA4G;YAE5G,MAAM,CAAC,SAAS,GAAG,MAAM,WAAW,OAAO,CACzC,CAAC;0DACiD,CAAC,EACnD;gBAAC;gBAAU,IAAI,KAAK;gBAAe;gBAAoB;gBAAiB;gBAAY;gBAAY;gBAAM;gBAAQ;gBAAU;gBAAW;gBAAY;gBAAU;gBAAkB;aAAM,CAAC,qBAAqB;;YAGzM,MAAM,UAAU,SAAS,QAAQ;YAEjC,IAAI,SAAS,MAAM,MAAM,GAAG,GAAG;gBAC7B,KAAK,MAAM,QAAQ,MAAO;oBACxB,MAAM,WAAW,OAAO,CACtB,CAAC;kDACqC,CAAC,EACvC;wBAAC;wBAAS,KAAK,UAAU;wBAAE,KAAK,WAAW;wBAAE,KAAK,UAAU;wBAAE,KAAK,MAAM,IAAI;wBAAM,KAAK,GAAG;wBAAE,OAAO,KAAK,QAAQ;wBAAG,OAAO,KAAK,SAAS;wBAAG,KAAK,gBAAgB,IAAI;wBAAG,KAAK,UAAU,IAAI;qBAAU;gBAEzM;YACF;YAEA,IAAI,uBAAuB;gBACzB,QAAQ,GAAG,CAAC,CAAC,2CAA2C,EAAE,sBAAsB,0CAA0C,CAAC;gBAC3H,MAAM,CAAC,gBAAgB,GAAG,MAAM,WAAW,OAAO,CAChD,iEACA;oBAAC;oBAAU;oBAAuB;iBAAW,CAAC,6CAA6C;;gBAE7F,IAAI,gBAAgB,YAAY,GAAG,GAAG;oBACpC,QAAQ,GAAG,CAAC,CAAC,0BAA0B,EAAE,sBAAsB,4BAA4B,CAAC;gBAC9F,OAAO;oBACL,QAAQ,IAAI,CAAC,CAAC,2CAA2C,EAAE,sBAAsB,uDAAuD,CAAC;gBAC3I;YACF;YAEA,MAAM,WAAW,MAAM;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAuC,MAAM;gBAAS,UAAU;YAAS,GAAG;gBAAE,QAAQ;YAAI;QAEhI,EAAE,OAAO,SAAS;YAChB,IAAI,YAAY;gBACd,MAAM,WAAW,QAAQ;YAC3B;YACA,QAAQ,KAAK,CAAC,8EAA8E;YAC5F,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAA0D,SAAS,QAAQ,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACxI,SAAU;YACR,IAAI,YAAY;gBACd,WAAW,OAAO;YACpB;QACF;IACF,OAAO,IAAI,eAAe,YAAY,QAAQ,CAAC,wBAAwB;QACrE,QAAQ,GAAG,CAAC;QACZ,IAAI;QACJ,IAAI;YACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;YACvC,MAAM,OAAO,SAAS,GAAG,CAAC;YAE1B,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;gBACrC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAwC,GAAG;oBAAE,QAAQ;gBAAI;YAC7F;YAEA,MAAM,aAAa,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;YACrD,MAAM,UAAU,EAAE;YAClB,MAAM,SAAS,qGAAA,CAAA,WAAQ,CAAC,IAAI,CAAC;YAE7B,MAAM,IAAI,QAAQ,CAAC,SAAS;gBAC1B,OACG,IAAI,CAAC,CAAA,GAAA,wIAAA,CAAA,UAAG,AAAD,EAAE;oBACR,YAAY,CAAC,EAAE,MAAM,EAAE,GAAK,OAAO,IAAI,GAAG,WAAW;gBACvD,IACC,EAAE,CAAC,QAAQ,CAAC,OAAS,QAAQ,IAAI,CAAC,OAClC,EAAE,CAAC,OAAO,SACV,EAAE,CAAC,SAAS;YACjB;YAEA,IAAI,QAAQ,MAAM,KAAK,GAAG;gBACxB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,SAAS;gBAA2D,GAAG;oBAAE,QAAQ;gBAAI;YAClH;YAEA,MAAM,qBAAqB,QAAQ,MAAM,CAAC,CAAC,KAAK;gBAC9C,MAAM,WAAW,IAAI,QAAQ,EAAE;gBAC/B,IAAI,CAAC,UAAU,OAAO;gBACtB,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,CAAC,SAAS,GAAG,EAAE;gBACtC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC;gBACnB,OAAO;YACT,GAAG,CAAC;YAEJ,aAAa,MAAM,+GAAA,CAAA,OAAI,CAAC,aAAa;YAErC,MAAM,CAAC,UAAU,GAAG,MAAM,WAAW,OAAO,CAAC;YAC7C,MAAM,CAAC,UAAU,GAAG,MAAM,WAAW,OAAO,CAAC;YAC7C,MAAM,CAAC,WAAW,GAAG,MAAM,WAAW,OAAO,CAAC;YAC9C,MAAM,CAAC,MAAM,GAAG,MAAM,WAAW,OAAO,CAAC;YAEzC,MAAM,cAAc,IAAI,IAAI,UAAU,GAAG,CAAC,CAAA,IAAK,EAAE,YAAY;YAC7D,MAAM,cAAc,IAAI,IAAI,UAAU,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;YACnD,MAAM,cAAc,IAAI,IAAI,WAAW,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;YACpD,MAAM,UAAU,IAAI,IAAI,MAAM,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;YAE3C,IAAI,oBAAoB;YACxB,IAAI,gBAAgB;YACpB,MAAM,SAAS,EAAE;YAEjB,MAAM,WAAW,gBAAgB;YAEjC,IAAK,MAAM,YAAY,mBAAoB;gBACzC,MAAM,UAAU,kBAAkB,CAAC,SAAS;gBAC5C,MAAM,YAAY,OAAO,CAAC,EAAE;gBAE5B,IAAI;oBACF,MAAM,eAAe,UAAU,YAAY,EAAE;oBAC7C,MAAM,aAAa,UAAU,UAAU,EAAE;oBACzC,MAAM,SAAS,UAAU,MAAM,EAAE;oBACjC,MAAM,QAAQ,UAAU,YAAY,EAAE;oBACtC,MAAM,wBAAwB,OAAO,UAAU,gBAAgB,IAAI,KAAK,WAAW,GAAG,IAAI;oBAE1F,IAAI,CAAC,YAAY,GAAG,CAAC,eAAe;wBAClC,MAAM,IAAI,MAAM,CAAC,eAAe,EAAE,aAAa,iBAAiB,CAAC;oBACnE;oBACA,IAAI,cAAc,CAAC,YAAY,GAAG,CAAC,aAAa;wBAC9C,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,WAAW,iBAAiB,CAAC;oBAC/D;oBAEA,IAAI,WAAW;oBACf,KAAK,MAAM,QAAQ,QAAS;wBAC1B,MAAM,MAAM,WAAW,KAAK,YAAY,EAAE;wBAC1C,MAAM,QAAQ,WAAW,KAAK,aAAa,EAAE;wBAC7C,IAAI,MAAM,QAAQ,MAAM,QAAQ;4BAC9B,MAAM,IAAI,MAAM,CAAC,iDAAiD,EAAE,SAAS,CAAC,CAAC;wBACjF;wBACA,YAAY,MAAM;oBACpB;oBAEA,MAAM,mBAAmB;wBAAC;wBAAQ;wBAAK;qBAAM,CAAC,QAAQ,CAAC;oBACvD,IAAI,YAAY;oBAChB,IAAI,UAAU,QAAQ,EAAE,WAAW,SAAS,CAAC,kBAAkB;wBAC3D,YAAY,WAAW;oBAC3B;oBACA,MAAM,aAAa,WAAW;oBAE9B,MAAM,gBAAgB,CAAC;;;UAGvB,CAAC;oBACD,MAAM,CAAC,SAAS,GAAG,MAAM,WAAW,OAAO,CAAC,eAAe;wBACzD;wBACA,SAAS,IAAI,KAAK,UAAU,IAAI;wBAChC;wBACA,UAAU,eAAe,EAAE,UAAU;wBACrC,gBAAgB;wBAChB,cAAc;wBACd;wBACA,UAAU,MAAM,EAAE,UAAU;wBAC5B;wBAAU;wBAAW;wBACrB,UAAU,QAAQ,EAAE,UAAU;wBAC9B;wBACA,SAAS;qBACV;oBACD,MAAM,UAAU,SAAS,QAAQ;oBAEjC,KAAK,MAAM,QAAQ,QAAS;wBAC1B,MAAM,aAAa,KAAK,cAAc,GAAG,SAAS,KAAK,cAAc,CAAC,IAAI,IAAI,MAAM;wBACpF,MAAM,SAAS,KAAK,UAAU,GAAG,SAAS,KAAK,UAAU,CAAC,IAAI,IAAI,MAAM;wBAExE,IAAI,cAAc,CAAC,YAAY,GAAG,CAAC,aAAa;4BAC5C,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,SAAS,6BAA6B,EAAE,YAAY;wBACtF;wBACA,IAAI,UAAU,CAAC,QAAQ,GAAG,CAAC,SAAS;4BAChC,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,SAAS,yBAAyB,EAAE,QAAQ;wBAC9E;wBAEA,MAAM,kBAAkB,CAAC;;;YAGzB,CAAC;wBACD,MAAM,WAAW,OAAO,CAAC,iBAAiB;4BACxC;4BACA,KAAK,cAAc,EAAE,UAAU;4BAC/B,KAAK,eAAe,EAAE,UAAU;4BAChC;4BAAY;4BACZ,KAAK,OAAO,EAAE,UAAU;4BACxB,WAAW,KAAK,YAAY,EAAE,WAAW;4BACzC,WAAW,KAAK,aAAa,EAAE,WAAW;yBAC3C;oBACH;oBACA;gBACF,EAAE,OAAO,OAAO;oBACd;oBACA,OAAO,IAAI,CAAC,CAAC,oBAAoB,EAAE,SAAS,EAAE,EAAE,MAAM,OAAO,EAAE;gBACjE;YACF;YAEA,IAAI,gBAAgB,GAAG;gBACrB,MAAM,WAAW,QAAQ;gBACzB,QAAQ,IAAI,CAAC,CAAC,yDAAyD,EAAE,cAAc,QAAQ,CAAC,EAAE;gBAClG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBACrB,SAAS,CAAC,qBAAqB,EAAE,kBAAkB,2DAA2D,EAAE,cAAc,0CAA0C,CAAC;oBACzK,QAAQ;gBACZ,GAAG;oBAAE,QAAQ;gBAAI;YACnB,OAAO;gBACL,MAAM,WAAW,MAAM;gBACvB,QAAQ,GAAG,CAAC,CAAC,iEAAiE,EAAE,kBAAkB,KAAK,CAAC;gBACxG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBACrB,SAAS,CAAC,sBAAsB,EAAE,kBAAkB,mDAAmD,CAAC;gBAC5G,GAAG;oBAAE,QAAQ;gBAAI;YACnB;QACF,EAAE,OAAO,OAAO;YACd,IAAI,YAAY,MAAM,WAAW,QAAQ;YACzC,QAAQ,KAAK,CAAC,yFAAyF;YACvG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAA+C,SAAS,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAC3H,SAAU;YACR,IAAI,YAAY,WAAW,OAAO;QACpC;IACF,OAAO;QACL,QAAQ,IAAI,CAAC,CAAC,gEAAgE,EAAE,aAAa;QAC7F,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF","debugId":null}}]
}