{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,oKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/form.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 264, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 514, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,uKAAA,CAAA,OAAsB;QACrB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,uKAAA,CAAA,YAA2B;YAC1B,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE;sBAEd,cAAA,6LAAC,uMAAA,CAAA,QAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,uKAAA,CAAA,OAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 566, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 669, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/purchase-orders/po-form.tsx"],"sourcesContent":["\n'use client';\n\nimport { useForm, useFieldArray, Controller } from 'react-hook-form';\nimport { Button } from '@/components/ui/button';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Separator } from '@/components/ui/separator';\nimport { PlusCircle, Trash2, Send, Printer, Loader2, Edit, Search, DownloadCloud } from 'lucide-react';\nimport type { Supplier, Site, Category as CategoryType, Approver, POItem as POFormItemStructure, PurchaseOrderPayload, POItemPayload, RequisitionPayload, RequisitionItem } from '@/types';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useRouter } from 'next/navigation';\nimport { format, parseISO } from 'date-fns';\n\ninterface POFormProps {\n  poIdToEditProp?: string | null;\n}\n\nconst defaultItem: POFormItemStructure = {\n  id: crypto.randomUUID(),\n  partNumber: '',\n  description: '',\n  categoryId: null,\n  siteId: null,    \n  uom: '',\n  quantity: 1,\n  unitPrice: 0.00,\n  quantityReceived: 0,\n  itemStatus: 'Pending',\n};\n\ninterface POFormValues {\n  vendorName: string | null;\n  vendorEmail: string;\n  salesPerson: string;\n  supplierContactNumber: string;\n  nuit: string;\n  quoteNo: string;\n  billingAddress: string;\n  poDate: string;\n  poNumberDisplay: string;\n  currency: string;\n  requestedByName: string;\n  approverId: string | null;\n  // overallSiteId: string | null; // Removed\n  pricesIncludeVat: boolean;\n  notes: string;\n  items: POFormItemStructure[];\n  selectedRequisitionId?: string | null; \n}\n\ninterface ApprovedRequisitionOption {\n    id: string;\n    requisitionNumber: string;\n    requisitionDate: string;\n    requestedByName: string;\n    siteName: string; \n    itemCount: number;\n    siteId: number; // Added siteId here\n}\n\n\nexport function POForm({ poIdToEditProp }: POFormProps) {\n  const { toast } = useToast();\n  const router = useRouter();\n  const [subTotal, setSubTotal] = useState(0);\n  const [vatAmount, setVatAmount] = useState(0);\n  const [grandTotal, setGrandTotal] = useState(0);\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isPrintingLoading, setIsPrintingLoading] = useState(false);\n  const [isLoadingInitialData, setIsLoadingInitialData] = useState(true); \n  const [isLoadingPOForEdit, setIsLoadingPOForEdit] = useState(false);\n  const [isLoadingRequisitionItems, setIsLoadingRequisitionItems] = useState(false);\n\n\n  const [isEditingLoadedPO, setIsEditingLoadedPO] = useState(false);\n  const [loadedPOId, setLoadedPOId] = useState<string | null>(null);\n\n  const [suppliers, setSuppliers] = useState<Supplier[]>([]);\n  const [sites, setSitesData] = useState<Site[]>([]); \n  const [categories, setCategories] = useState<CategoryType[]>([]);\n  const [approvers, setApproversData] = useState<Approver[]>([]);\n  const [approvedRequisitions, setApprovedRequisitions] = useState<ApprovedRequisitionOption[]>([]);\n\n\n  const form = useForm<POFormValues>({\n    defaultValues: {\n      vendorName: null, vendorEmail: '', salesPerson: '', supplierContactNumber: '', nuit: '',\n      quoteNo: '', billingAddress: '', poDate: format(new Date(), 'yyyy-MM-dd'),\n      poNumberDisplay: 'Loading PO...', currency: 'MZN', requestedByName: '',\n      approverId: null, /* overallSiteId: null, */ pricesIncludeVat: false, notes: '', items: [{...defaultItem}],\n      selectedRequisitionId: null,\n    },\n    mode: 'onBlur',\n  });\n\n  const { fields, append, remove, replace } = useFieldArray({\n    control: form.control,\n    name: 'items',\n  });\n\n  const loadPODataIntoForm = useCallback((data: PurchaseOrderPayload, currentSuppliers: Supplier[]) => {\n    form.reset({\n      vendorName: data.supplierId,\n      vendorEmail: data.supplierDetails?.emailAddress || '',\n      salesPerson: data.supplierDetails?.salesPerson || '',\n      supplierContactNumber: data.supplierDetails?.cellNumber || '',\n      nuit: data.supplierDetails?.nuitNumber || '',\n      billingAddress: data.supplierDetails?.physicalAddress || '',\n      quoteNo: data.quoteNo || '',\n      poDate: data.creationDate ? format(parseISO(data.creationDate), 'yyyy-MM-dd') : format(new Date(), 'yyyy-MM-dd'),\n      poNumberDisplay: data.poNumber,\n      currency: data.currency,\n      requestedByName: data.requestedByName || '',\n      approverId: data.approverId,\n      // overallSiteId: data.siteId ? data.siteId.toString() : null, // Removed overallSiteId mapping\n      pricesIncludeVat: data.pricesIncludeVat,\n      notes: data.notes || '',\n      items: (data.items || []).map(item => ({\n        id: crypto.randomUUID(),\n        partNumber: item.partNumber || '',\n        description: item.description,\n        categoryId: item.categoryId,\n        siteId: item.siteId, \n        uom: item.uom,\n        quantity: item.quantity,\n        unitPrice: item.unitPrice,\n        quantityReceived: item.quantityReceived || 0,\n        itemStatus: item.itemStatus || 'Pending',\n      })),\n      selectedRequisitionId: null,\n    });\n\n    if (data.supplierId) {\n      const selectedSupplier = currentSuppliers.find(s => s.supplierCode === data.supplierId);\n      if (selectedSupplier) {\n        form.setValue('vendorEmail', selectedSupplier.emailAddress || '');\n        form.setValue('salesPerson', selectedSupplier.salesPerson || '');\n        form.setValue('supplierContactNumber', selectedSupplier.cellNumber || '');\n        form.setValue('nuit', selectedSupplier.nuitNumber || '');\n        form.setValue('billingAddress', selectedSupplier.physicalAddress || '');\n      }\n    }\n    setIsEditingLoadedPO(true);\n    setLoadedPOId(String(data.id));\n  }, [form]);\n\n  const resetFormForNew = useCallback(async (fetchNextNumber = true) => {\n    form.reset({\n      vendorName: null, vendorEmail: '', salesPerson: '', supplierContactNumber: '', nuit: '',\n      quoteNo: '', billingAddress: '', poDate: format(new Date(), 'yyyy-MM-dd'),\n      poNumberDisplay: fetchNextNumber ? 'Fetching...' : form.getValues('poNumberDisplay'), \n      currency: 'MZN', requestedByName: '',\n      approverId: null, /* overallSiteId: null, */ pricesIncludeVat: false, notes: '', items: [{...defaultItem}],\n      selectedRequisitionId: null,\n    });\n    setIsEditingLoadedPO(false);\n    setLoadedPOId(null);\n    if (fetchNextNumber) {\n      try {\n        const response = await fetch('/api/purchase-orders/next-po-number');\n        if (!response.ok) throw new Error('Failed to fetch next PO number');\n        const data = await response.json();\n        form.setValue('poNumberDisplay', data.nextPoNumber || 'PO-ERROR');\n      } catch (error) {\n        form.setValue('poNumberDisplay', 'PO-ERROR');\n        toast({ title: \"Error\", description: \"Could not load next PO number.\", variant: \"destructive\" });\n      }\n    }\n  }, [form, toast]);\n\n\n  useEffect(() => {\n    const fetchCoreDataAndInitializeForm = async () => {\n      setIsLoadingInitialData(true);\n      let fetchedSuppliers: Supplier[] = [];\n\n      try {\n        const [suppliersRes, sitesRes, categoriesRes, approversRes, approvedReqsRes] = await Promise.all([\n          fetch('/api/suppliers'), fetch('/api/sites'), fetch('/api/categories'), fetch('/api/approvers'),\n          fetch('/api/requisitions/for-po-creation'),\n        ]);\n\n        fetchedSuppliers = suppliersRes.ok ? await suppliersRes.json() : [];\n        const fetchedSites: Site[] = sitesRes.ok ? await sitesRes.json() : [];\n        const fetchedCategories: CategoryType[] = categoriesRes.ok ? await categoriesRes.json() : [];\n        const fetchedApprovers: Approver[] = approversRes.ok ? await approversRes.json() : [];\n        // The approvedRequisitions now need to include the header siteId from the Requisition\n        const fetchedApprovedReqsRaw: any[] = approvedReqsRes.ok ? await approvedReqsRes.json() : [];\n        const fetchedApprovedReqs: ApprovedRequisitionOption[] = fetchedApprovedReqsRaw.map(req => ({\n            ...req,\n            // Assuming the API for /api/requisitions/for-po-creation now returns siteId on the requisition header\n            // If not, this would need to be fetched separately or the API updated.\n            // For now, let's assume 'siteName' is the code and we'll fetch full Site details later if needed for siteId.\n            // This part might need refinement if the API for `for-po-creation` doesn't provide Requisition.siteId\n        }));\n\n\n        setSuppliers(fetchedSuppliers);\n        setSitesData(fetchedSites);\n        setCategories(fetchedCategories);\n        setApproversData(fetchedApprovers);\n        setApprovedRequisitions(fetchedApprovedReqs);\n\n\n        if (poIdToEditProp) {\n          setIsLoadingPOForEdit(true);\n          const poHeaderRes = await fetch(`/api/purchase-orders/${poIdToEditProp}`);\n          if (!poHeaderRes.ok) throw new Error(`Failed to fetch PO Header ${poIdToEditProp}`);\n          const poDataToEdit: PurchaseOrderPayload = await poHeaderRes.json();\n\n          const poItemsRes = await fetch(`/api/purchase-orders/${poIdToEditProp}/items`);\n          if (!poItemsRes.ok) throw new Error(`Failed to fetch PO Items for ${poIdToEditProp}`);\n          const poItemsData: POItemPayload[] = await poItemsRes.json();\n          poDataToEdit.items = poItemsData;\n\n          if (poDataToEdit.supplierId && !poDataToEdit.supplierDetails) {\n             poDataToEdit.supplierDetails = fetchedSuppliers.find(s => s.supplierCode === poDataToEdit.supplierId);\n          }\n          loadPODataIntoForm(poDataToEdit, fetchedSuppliers);\n          setIsLoadingPOForEdit(false);\n        } else {\n          await resetFormForNew();\n        }\n      } catch (error) {\n        toast({ title: \"Error Loading Data\", description: `Failed to load initial form data: ${error instanceof Error ? error.message : String(error)}`, variant: \"destructive\" });\n        if (!poIdToEditProp) form.setValue('poNumberDisplay', 'PO-ERROR');\n      } finally {\n        setIsLoadingInitialData(false);\n      }\n    };\n    fetchCoreDataAndInitializeForm();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [poIdToEditProp, toast]); \n\n\n  const watchedItems = form.watch('items');\n  const watchedCurrency = form.watch('currency');\n  const watchedPricesIncludeVat = form.watch('pricesIncludeVat');\n\n  useEffect(() => {\n    const items = watchedItems || [];\n    let calculatedInputSum = 0;\n    items.forEach((item: POFormItemStructure) => {\n        const quantity = Number(item.quantity) || 0;\n        const unitPrice = Number(item.unitPrice) || 0;\n        calculatedInputSum += quantity * unitPrice;\n    });\n    let newDisplaySubTotal = calculatedInputSum;\n    let newDisplayVatAmount = 0;\n    if (watchedCurrency === 'MZN' && !watchedPricesIncludeVat) {\n        newDisplayVatAmount = newDisplaySubTotal * 0.16;\n    }\n    setSubTotal(parseFloat(newDisplaySubTotal.toFixed(2)));\n    setVatAmount(parseFloat(newDisplayVatAmount.toFixed(2)));\n    setGrandTotal(parseFloat((newDisplaySubTotal + newDisplayVatAmount).toFixed(2)));\n  }, [watchedItems, watchedCurrency, watchedPricesIncludeVat]);\n\n  const handleLoadPOForEditing = async () => {\n    const poNumberToLoad = form.getValues('poNumberDisplay');\n    if (!poNumberToLoad || poNumberToLoad === 'Loading PO...' || poNumberToLoad === 'Fetching...' || poNumberToLoad === 'PO-ERROR') {\n      toast({ title: \"PO Number Required\", description: \"Please enter a PO number to load.\", variant: \"destructive\"});\n      return;\n    }\n    setIsLoadingPOForEdit(true);\n    try {\n      const idRes = await fetch(`/api/purchase-orders/get-by-po-number/${encodeURIComponent(poNumberToLoad)}`);\n      if (!idRes.ok) {\n         const errorData = await idRes.json().catch(() => ({}));\n        throw new Error(errorData.error || `PO Number ${poNumberToLoad} not found.`);\n      }\n      const { id: foundPoId } = await idRes.json();\n\n      if (!foundPoId) throw new Error(`PO Number ${poNumberToLoad} not found.`);\n\n      const poHeaderRes = await fetch(`/api/purchase-orders/${foundPoId}`);\n      if (!poHeaderRes.ok) throw new Error(`Failed to fetch PO Header for PO ID ${foundPoId}.`);\n      const poDataToLoad: PurchaseOrderPayload = await poHeaderRes.json();\n\n      const poItemsRes = await fetch(`/api/purchase-orders/${foundPoId}/items`);\n      if (!poItemsRes.ok) throw new Error(`Failed to fetch PO Items for ID ${foundPoId}`);\n      const poItemsData: POItemPayload[] = await poItemsRes.json();\n      poDataToLoad.items = poItemsData;\n\n      if (poDataToLoad.status !== 'Pending Approval' && poDataToLoad.status !== 'Draft' && poDataToLoad.status !== 'Rejected') {\n        toast({ title: \"Cannot Edit\", description: `PO ${poNumberToLoad} is in '${poDataToLoad.status}' status and cannot be edited.`, variant: \"destructive\"});\n        setIsLoadingPOForEdit(false);\n        return;\n      }\n\n       if (poDataToLoad.supplierId && !poDataToLoad.supplierDetails) {\n         poDataToLoad.supplierDetails = suppliers.find(s => s.supplierCode === poDataToLoad.supplierId);\n       }\n      loadPODataIntoForm(poDataToLoad, suppliers);\n      toast({title: \"PO Loaded\", description: `PO ${poNumberToLoad} loaded for editing.`});\n    } catch (error) {\n      toast({ title: \"Error Loading PO\", description: `${error instanceof Error ? error.message : String(error)}`, variant: \"destructive\"});\n    } finally {\n      setIsLoadingPOForEdit(false);\n    }\n  };\n\n   const handleLoadRequisitionItems = async () => {\n    const requisitionId = form.getValues('selectedRequisitionId');\n    if (!requisitionId) {\n      toast({ title: 'No Requisition Selected', description: 'Please select an approved requisition to load items.', variant: 'info' });\n      return;\n    }\n    setIsLoadingRequisitionItems(true);\n    try {\n      const response = await fetch(`/api/requisitions/${requisitionId}`);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `Failed to fetch requisition details for ID ${requisitionId}.`);\n      }\n      const requisitionData: RequisitionPayload = await response.json();\n\n      form.setValue('requestedByName', requisitionData.requestedByName || requisitionData.requestorFullName || '');\n      const currentNotes = form.getValues('notes') || '';\n      form.setValue('notes', `${currentNotes}\\nItems loaded from Requisition: ${requisitionData.requisitionNumber}`.trim());\n\n      const newPOItems = requisitionData.items.map(reqItem => ({\n        ...defaultItem, \n        id: crypto.randomUUID(),\n        partNumber: reqItem.partNumber || '',\n        description: reqItem.description,\n        categoryId: reqItem.categoryId,\n        siteId: requisitionData.siteId, // Use Requisition header siteId for each PO item's siteId\n        uom: (reqItem as any).uom || 'EA',\n        quantity: reqItem.quantity,\n        unitPrice: 0.00,\n        quantityReceived: 0,\n        itemStatus: 'Pending',\n      }));\n\n      replace(newPOItems);\n      toast({ title: 'Items Loaded', description: `Items from Requisition ${requisitionData.requisitionNumber} loaded. Each item's site set to Req Header Site ID: ${requisitionData.siteId}.` });\n    } catch (error: any) {\n      toast({ title: 'Error Loading Requisition Items', description: error.message, variant: 'destructive' });\n    } finally {\n      setIsLoadingRequisitionItems(false);\n    }\n  };\n\n\n  const onSubmit = async (formData: POFormValues) => {\n    if (!formData.items || formData.items.length === 0) {\n      toast({ title: \"Validation Error\", description: \"Please add at least one item.\", variant: \"destructive\" });\n      return;\n    }\n    setIsSubmitting(true);\n\n    const payload = {\n      poNumber: formData.poNumberDisplay,\n      creationDate: new Date(formData.poDate).toISOString(),\n      requestedByName: formData.requestedByName,\n      supplierId: formData.vendorName,\n      approverId: formData.approverId,\n      // siteId: formData.overallSiteId ? Number(formData.overallSiteId) : null, // Removed overallSiteId\n      siteId: null, // PO Header siteId is now always null from this form\n      subTotal: subTotal, vatAmount: vatAmount, grandTotal: grandTotal, currency: formData.currency,\n      pricesIncludeVat: formData.pricesIncludeVat, notes: formData.notes,\n      items: formData.items.map(item => ({\n        partNumber: item.partNumber, description: item.description, categoryId: item.categoryId ? Number(item.categoryId) : null,\n        siteId: item.siteId ? Number(item.siteId) : null, uom: item.uom, quantity: Number(item.quantity), unitPrice: Number(item.unitPrice),\n        quantityReceived: item.quantityReceived || 0,\n        itemStatus: item.itemStatus || 'Pending',\n      })),\n      quoteNo: formData.quoteNo,\n      status: isEditingLoadedPO && loadedPOId && form.getValues('status' as any) === 'Rejected' ? 'Pending Approval' : 'Pending Approval',\n      creatorUserId: null,\n      selectedRequisitionId: formData.selectedRequisitionId || null, // Pass selectedRequisitionId to backend\n    };\n\n    try {\n      let response;\n      let successMessage = '';\n\n      if (isEditingLoadedPO && loadedPOId) {\n        response = await fetch(`/api/purchase-orders/${loadedPOId}`, {\n          method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload),\n        });\n        successMessage = `Purchase Order ${payload.poNumber} updated successfully.`;\n      } else {\n        response = await fetch('/api/purchase-orders', {\n          method: 'POST', headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(payload),\n        });\n        successMessage = `Purchase Order ${payload.poNumber} created successfully.`;\n      }\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: `Failed to ${isEditingLoadedPO ? 'update' : 'submit'} PO. Server error.` }));\n        throw new Error(errorData.error || `Server error: ${response.status} - ${errorData.details || response.statusText}`);\n      }\n      const result = await response.json();\n      toast({ title: 'Success!', description: successMessage });\n\n      if (result.poId) {\n        const contextParam = (isEditingLoadedPO || loadedPOId) ? '' : '?context=creator';\n        router.push(`/purchase-orders/${result.poId}/print${contextParam}`);\n      } else if (!isEditingLoadedPO) {\n        await resetFormForNew();\n      }\n\n    } catch (error: any) {\n      toast({ title: `Error ${isEditingLoadedPO ? 'Updating' : 'Submitting'} PO`, description: error.message || 'An unexpected error occurred.', variant: \"destructive\" });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleViewPrintPO = async () => {\n    setIsPrintingLoading(true);\n    try {\n      let targetPoId = loadedPOId;\n      if (!targetPoId) {\n        const poNumberInForm = form.getValues('poNumberDisplay');\n        if (!poNumberInForm || ['Loading PO...', 'Fetching...', 'PO-ERROR'].includes(poNumberInForm)) {\n          toast({ title: 'PO Number Required', description: 'PO Number must be available to view/print.', variant: 'destructive' }); return;\n        }\n        const res = await fetch(`/api/purchase-orders/get-by-po-number/${encodeURIComponent(poNumberInForm)}`);\n        if (res.ok) { const poDetails = await res.json(); targetPoId = poDetails.id; }\n        else { toast({ title: 'PO Not Found', description: `PO ${poNumberInForm} not found. Save it first.`, variant: 'destructive' }); return; }\n      }\n      if (targetPoId) {\n        const contextParam = (isEditingLoadedPO || loadedPOId) ? '' : '?context=creator';\n        window.open(`/purchase-orders/${targetPoId}/print${contextParam}`, '_blank');\n      } else {\n        toast({ title: 'Error', description: 'Could not determine PO to view/print.', variant: 'destructive' });\n      }\n    } catch (error: any) {\n      toast({ title: 'Error', description: `Could not prepare PO for printing: ${error.message}`, variant: 'destructive' });\n    } finally {\n      setIsPrintingLoading(false);\n    }\n  };\n\n  const handleSupplierChange = (selectedSupplierCode: string | null) => {\n    const selectedSupplier = suppliers.find(s => s.supplierCode === selectedSupplierCode);\n    if (selectedSupplier) {\n      form.setValue('vendorName', selectedSupplier.supplierCode);\n      form.setValue('vendorEmail', selectedSupplier.emailAddress || '');\n      form.setValue('salesPerson', selectedSupplier.salesPerson || '');\n      form.setValue('supplierContactNumber', selectedSupplier.cellNumber || '');\n      form.setValue('nuit', selectedSupplier.nuitNumber || '');\n      form.setValue('billingAddress', selectedSupplier.physicalAddress || '');\n    } else {\n      form.setValue('vendorEmail', ''); form.setValue('salesPerson', ''); form.setValue('supplierContactNumber', '');\n      form.setValue('nuit', ''); form.setValue('billingAddress', '');\n    }\n  };\n\n  const currencySymbol = watchedCurrency === 'MZN' ? 'MZN' : '$';\n  const formatValue = (value: number) => value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n\n  if (isLoadingInitialData && !poIdToEditProp) {\n    return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading form data...</div>;\n  }\n  if (isLoadingPOForEdit && poIdToEditProp) {\n     return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading PO for editing...</div>;\n  }\n\n  return (\n    <Card className=\"w-full max-w-6xl mx-auto shadow-xl hover:shadow-2xl hover:scale-[1.02] transition-all duration-300 ease-in-out\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-2xl\">{isEditingLoadedPO ? `Editing PO: ${form.getValues('poNumberDisplay')}` : 'Create New Purchase Order'}</CardTitle>\n      </CardHeader>\n      <CardContent className=\"pt-6\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\n            {!isEditingLoadedPO && (\n              <div className=\"p-4 border rounded-md bg-muted/30 space-y-3 mb-6\">\n                <h3 className=\"text-md font-medium text-primary\">Load from Approved Requisition</h3>\n                <div className=\"grid md:grid-cols-3 gap-4 items-end\">\n                    <FormField\n                    control={form.control}\n                    name=\"selectedRequisitionId\"\n                    render={({ field }) => (\n                        <FormItem className=\"md:col-span-2\">\n                        <FormLabel>Select Requisition</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || ''} disabled={isLoadingRequisitionItems}>\n                            <FormControl><SelectTrigger><SelectValue placeholder=\"Choose an approved requisition...\" /></SelectTrigger></FormControl>\n                            <SelectContent>\n                              {approvedRequisitions.length === 0 ? (\n                                <div className=\"p-2 text-sm text-muted-foreground\">No approved requisitions found</div>\n                              ) : (\n                                approvedRequisitions.map(req => (\n                                    <SelectItem key={req.id} value={req.id}>\n                                    {req.requisitionNumber} ({req.siteName}) - {req.itemCount} items - Req by: {req.requestedByName} on {format(parseISO(req.requisitionDate), 'dd MMM yyyy')}\n                                    </SelectItem>\n                                ))\n                              )}\n                            </SelectContent>\n                        </Select>\n                        <FormMessage />\n                        </FormItem>\n                    )}\n                    />\n                    <Button \n                        type=\"button\" \n                        onClick={handleLoadRequisitionItems} \n                        disabled={!form.watch('selectedRequisitionId') || isLoadingRequisitionItems}\n                        variant=\"outline\"\n                    >\n                        {isLoadingRequisitionItems ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <DownloadCloud className=\"mr-2 h-4 w-4\" />}\n                        Load Items\n                    </Button>\n                </div>\n              </div>\n            )}\n\n\n            <div>\n              <h3 className=\"text-lg font-medium font-headline mb-2\">Supplier & PO Information</h3>\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                <FormField\n                  control={form.control} name=\"poNumberDisplay\" rules={{ required: 'PO Number is required' }}\n                  render={({ field }) => (\n                    <FormItem className=\"lg:col-span-2\">\n                      <FormLabel>PO Number</FormLabel>\n                      <div className=\"flex gap-2\">\n                        <FormControl>\n                          <Input placeholder=\"PO Number or type to load\" {...field} readOnly={isEditingLoadedPO} />\n                        </FormControl>\n                        {!isEditingLoadedPO && (\n                           <Button type=\"button\" variant=\"outline\" onClick={handleLoadPOForEditing} disabled={isLoadingPOForEdit} className=\"shrink-0\">\n                            {isLoadingPOForEdit ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Search className=\"h-4 w-4\" />} Load\n                           </Button>\n                        )}\n                      </div>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField control={form.control} name=\"quoteNo\" render={({ field }) => ( <FormItem> <FormLabel>Quote No.</FormLabel> <FormControl><Input placeholder=\"e.g. QT-001\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"poDate\" rules={{ required: 'PO Date is required' }} render={({ field }) => ( <FormItem> <FormLabel>PO Date</FormLabel> <FormControl><Input type=\"date\" {...field} /></FormControl> <FormMessage /> </FormItem> )} />\n              </div>\n\n              <div className=\"grid md:grid-cols-3 gap-4 mt-4\">\n                <FormField\n                  control={form.control} name=\"vendorName\" rules={{ required: 'Supplier is required' }}\n                  render={({ field }) => (\n                    <FormItem> <FormLabel>Supplier Name</FormLabel>\n                      <Select onValueChange={(value) => { field.onChange(value); handleSupplierChange(value); }} value={field.value || ''}>\n                        <FormControl><SelectTrigger><SelectValue placeholder=\"Select a supplier\" /></SelectTrigger></FormControl>\n                        <SelectContent>{suppliers.map(s => (<SelectItem key={s.supplierCode} value={s.supplierCode}>{s.supplierName} ({s.supplierCode})</SelectItem>))}</SelectContent>\n                      </Select> <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField control={form.control} name=\"vendorEmail\" render={({ field }) => ( <FormItem> <FormLabel>Supplier Email</FormLabel> <FormControl><Input type=\"email\" placeholder=\"e.g. supplier@example.com\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"salesPerson\" render={({ field }) => ( <FormItem> <FormLabel>Sales Person</FormLabel> <FormControl><Input placeholder=\"e.g. Mr. Sales\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mt-4\">\n                <FormField control={form.control} name=\"supplierContactNumber\" render={({ field }) => ( <FormItem className=\"md:col-span-1\"> <FormLabel>Supplier Contact</FormLabel> <FormControl><Input placeholder=\"e.g. +258 123 4567\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"nuit\" render={({ field }) => ( <FormItem className=\"md:col-span-1\"> <FormLabel>NUIT</FormLabel> <FormControl><Input placeholder=\"e.g. 123456789\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"billingAddress\" render={({ field }) => ( <FormItem className=\"md:col-span-3\"> <FormLabel>Supplier Address (for PDF)</FormLabel> <FormControl><Textarea placeholder=\"Enter supplier's billing address...\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n              </div>\n            </div>\n\n            <div>\n              <h3 className=\"text-lg font-medium font-headline mb-2 mt-4\">PO Configuration</h3>\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-4 items-center\"> {/* Reduced to 4 columns */}\n                {/* Overall PO Site Field Removed */}\n                <FormField control={form.control} name=\"currency\" render={({ field }) => ( <FormItem className=\"lg:col-span-1\"> <FormLabel>Currency</FormLabel> <Select onValueChange={field.onChange} value={field.value || 'MZN'}> <FormControl><SelectTrigger><SelectValue placeholder=\"Select currency\" /></SelectTrigger></FormControl> <SelectContent><SelectItem value=\"MZN\">MZN</SelectItem><SelectItem value=\"USD\">USD</SelectItem></SelectContent> </Select> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"requestedByName\" rules={{ required: 'Requested By is required' }} render={({ field }) => ( <FormItem className=\"lg:col-span-1\"> <FormLabel>Requested By</FormLabel> <FormControl><Input placeholder=\"Enter requester's name\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"approverId\" rules={{ required: 'Approver is required' }} render={({ field }) => ( <FormItem className=\"lg:col-span-1\"> <FormLabel>Approver</FormLabel> <Select onValueChange={field.onChange} value={field.value || ''}> <FormControl><SelectTrigger><SelectValue placeholder=\"Select an approver\" /></SelectTrigger></FormControl> <SelectContent>{approvers.map(appr => (<SelectItem key={appr.id} value={appr.id}>{appr.name}</SelectItem>))}</SelectContent> </Select> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"pricesIncludeVat\" render={({ field }) => ( <FormItem className=\"lg:col-span-1 flex flex-row items-center space-x-3 space-y-0 rounded-md border p-3 h-10 mt-auto\"> <FormControl><Checkbox checked={field.value} onCheckedChange={field.onChange} /></FormControl> <div className=\"space-y-1 leading-none\"><FormLabel>Prices VAT inclusive</FormLabel></div> </FormItem> )} />\n             </div>\n            </div>\n\n            <Separator />\n            <h3 className=\"text-lg font-medium font-headline\">Items</h3>\n            {fields.map((itemField, index) => {\n              const itemQuantity = form.watch(`items.${index}.quantity`) || 0;\n              const itemUnitPrice = form.watch(`items.${index}.unitPrice`) || 0;\n              const itemTotal = (Number(itemQuantity) * Number(itemUnitPrice));\n              return (\n                <Card key={itemField.id} className=\"p-4 space-y-4 relative mb-4 shadow-md\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-6 lg:grid-cols-12 gap-x-4 gap-y-2 items-end\">\n                    <FormField control={form.control} name={`items.${index}.partNumber`} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Part Number</FormLabel>\n                        <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl>\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.description`} rules={{ required: 'Description is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-3\">\n                        <FormLabel>Description</FormLabel>\n                        <FormControl><Input placeholder=\"Item description\" {...field} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.categoryId`} rules={{ required: 'Category is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Category</FormLabel>\n                        <Select onValueChange={(v) => field.onChange(v ? Number(v) : null)} value={field.value?.toString() || ''}>\n                          <FormControl><SelectTrigger><SelectValue placeholder=\"Select\" /></SelectTrigger></FormControl>\n                          <SelectContent>{categories.map(cat => (<SelectItem key={cat.id} value={cat.id.toString()}>{cat.category}</SelectItem>))}</SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.siteId`} rules={{ required: 'Item Site is required' }} render={({ field }) => ( \n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Item Site</FormLabel>\n                        <Select onValueChange={(v) => field.onChange(v ? Number(v) : null)} value={field.value?.toString() || ''}>\n                          <FormControl><SelectTrigger><SelectValue placeholder=\"Select\" /></SelectTrigger></FormControl>\n                          <SelectContent>{sites.map(site => (<SelectItem key={site.id} value={site.id.toString()}>{site.siteCode || site.name}</SelectItem>))}</SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.uom`} rules={{ required: 'UOM is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>UOM</FormLabel>\n                        <FormControl><Input placeholder=\"e.g., EA\" {...field} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.quantity`} rules={{ required: 'Quantity is required', min: { value: 1, message: 'Must be at least 1' } }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Quantity</FormLabel>\n                        <FormControl><Input type=\"number\" placeholder=\"0\" {...field} onChange={e => field.onChange(parseFloat(e.target.value) || 0)} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.unitPrice`} rules={{ required: 'Unit Price is required', min: { value: 0, message: 'Cannot be negative' } }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Unit Price ({currencySymbol})</FormLabel>\n                        <FormControl><Input type=\"number\" step=\"0.01\" placeholder=\"0.00\" {...field} onChange={e => field.onChange(parseFloat(e.target.value) || 0.00)} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormItem className=\"lg:col-span-2\">\n                      <FormLabel>Item Total ({currencySymbol})</FormLabel>\n                      <div className=\"h-10 w-full rounded-md border border-input bg-muted/30 px-3 py-2 text-sm text-muted-foreground flex items-center\">{formatValue(itemTotal)}</div>\n                    </FormItem>\n                  </div>\n                  {fields.length > 1 && (<Button type=\"button\" variant=\"destructive\" size=\"icon\" onClick={() => remove(index)} className=\"absolute top-2 right-2\" title=\"Remove Item\"><Trash2 className=\"h-4 w-4\" /></Button>)}\n                </Card>\n              );\n            })}\n            <Button type=\"button\" variant=\"outline\" onClick={() => append({...defaultItem, id: crypto.randomUUID() })} className=\"mt-0\"><PlusCircle className=\"mr-2 h-4 w-4\" /> Add Item</Button>\n\n            <Separator className=\"my-6\"/>\n\n            <div className=\"grid md:grid-cols-3 gap-6 mt-8 items-start\">\n                <FormField\n                  control={form.control}\n                  name=\"notes\"\n                  render={({ field }) => (\n                    <FormItem className=\"md:col-span-1\">\n                      <FormLabel>Notes</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Add any relevant notes...\"\n                          className=\"resize-none h-40\"\n                          {...field}\n                          value={field.value ?? ''}\n                        />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n\n              <div className=\"md:col-span-1 space-y-2 text-left border p-4 rounded-md bg-muted/20\">\n                <div className=\"text-md\">Subtotal ({currencySymbol}): <span className=\"font-semibold\">{formatValue(subTotal)}</span></div>\n                {(() => {\n                  if (watchedCurrency === 'MZN' && !watchedPricesIncludeVat) {\n                    return <div className=\"text-md\">VAT (16%) ({currencySymbol}): <span className=\"font-semibold\">{formatValue(vatAmount)}</span></div>;\n                  }\n                  if (watchedPricesIncludeVat) {\n                    return <div className=\"text-sm text-muted-foreground\">VAT is included in item prices.</div>;\n                  }\n                  return null;\n                })()}\n                <div className=\"text-xl font-bold font-headline\">Grand Total ({currencySymbol}): <span className=\"font-semibold\">{formatValue(grandTotal)}</span></div>\n              </div>\n\n              <div className=\"md:col-span-1 flex flex-col gap-3 w-full\">\n                <Button type=\"submit\" size=\"lg\" className=\"w-full\" disabled={isSubmitting || isLoadingPOForEdit || isLoadingRequisitionItems || (!form.formState.isValid && form.formState.isSubmitted)}>\n                  {isSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : (isEditingLoadedPO ? <Edit className=\"mr-2 h-4 w-4\" /> : <Send className=\"mr-2 h-4 w-4\" />)}\n                  {isSubmitting ? (isEditingLoadedPO ? 'Updating PO...' : 'Submitting PO...') : (isEditingLoadedPO ? 'Update PO' : 'Submit PO')}\n                </Button>\n                <Button type=\"button\" variant=\"outline\" size=\"lg\" className=\"w-full\" onClick={handleViewPrintPO} disabled={isPrintingLoading || (!isEditingLoadedPO && !form.getValues('poNumberDisplay'))}>\n                  {isPrintingLoading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Printer className=\"mr-2 h-4 w-4\" /> }\n                  {isPrintingLoading ? 'Loading Preview...' : 'View/Print PO'}\n                </Button>\n                 {!isEditingLoadedPO && (\n                  <Button type=\"button\" variant=\"ghost\" size=\"lg\" className=\"w-full\" onClick={() => resetFormForNew()} disabled={isSubmitting || isLoadingPOForEdit || isLoadingRequisitionItems}>\n                    Clear / New PO\n                  </Button>\n                )}\n              </div>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n      <CardFooter>\n        <p className=\"text-xs text-muted-foreground\">\n          {isEditingLoadedPO ? `Editing PO: ${form.getValues('poNumberDisplay')}. PO Number is read-only.` : \"Enter PO details. Use 'Load' for existing editable POs or create a new one.\"}\n          When loading from a requisition, item sites are derived from the requisition's header.\n        </p>\n      </CardFooter>\n    </Card>\n  );\n}\n    \n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3054, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,KAAK;YACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;;AAIf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAEzE,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,2DACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,+EACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,oGACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,kDAAkD;QAC/D,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 3192, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/receiving/grn-interface.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { CheckSquare, PackageSearch, Loader2, FileSearch, AlertTriangle, FilePlus } from 'lucide-react';\nimport type { POItemPayload, PurchaseOrderPayload, ApprovedPOForSelect, GRNItemFormData, GRNPostPayload } from '@/types';\nimport { useToast } from '@/hooks/use-toast';\nimport { format } from 'date-fns';\n\nconst MOCK_RECEIVED_BY_USER_ID = 'user_grn_001'; \n\nexport function GRNInterface() {\n  const { toast } = useToast();\n\n  const [grnDate, setGrnDate] = useState<string>(format(new Date(), 'yyyy-MM-dd'));\n  const [selectedPOId, setSelectedPOId] = useState<string>('');\n  const [deliveryNote, setDeliveryNote] = useState<string>('');\n  const [overallGrnNotes, setOverallGrnNotes] = useState<string>('');\n\n  const [approvedPOsForSelect, setApprovedPOsForSelect] = useState<ApprovedPOForSelect[]>([]);\n  const [loadedPOHeader, setLoadedPOHeader] = useState<PurchaseOrderPayload | null>(null);\n  const [grnItems, setGrnItems] = useState<GRNItemFormData[]>([]);\n  \n  const [isLoadingPOsForSelect, setIsLoadingPOsForSelect] = useState(false);\n  const [isLoadingPODetails, setIsLoadingPODetails] = useState(false);\n  const [isSubmittingGRN, setIsSubmittingGRN] = useState(false);\n  const [errorMessages, setErrorMessages] = useState<{ general?: string; poSelect?: string; }>({});\n\n  const fetchInitialData = useCallback(async () => {\n    setIsLoadingPOsForSelect(true);\n    setErrorMessages({});\n    try {\n      const posRes = await fetch('/api/purchase-orders/for-grn-selection');\n      if (posRes.ok) {\n        setApprovedPOsForSelect(await posRes.json());\n      } else {\n        const err = await posRes.json().catch(() => ({}));\n        setErrorMessages(prev => ({ ...prev, poSelect: `Failed to load POs: ${err.message || posRes.statusText}` }));\n      }\n    } catch (error: any) {\n      setErrorMessages(prev => ({ ...prev, general: `Error fetching POs for selection: ${error.message}`}));\n      toast({ title: \"Error\", description: \"Could not load initial data for GRN form.\", variant: \"destructive\" });\n    } finally {\n      setIsLoadingPOsForSelect(false);\n    }\n  }, [toast]);\n\n  useEffect(() => {\n    fetchInitialData();\n  }, [fetchInitialData]);\n\n  const resetFormForNew = () => {\n    setGrnDate(format(new Date(), 'yyyy-MM-dd'));\n    setSelectedPOId('');\n    setDeliveryNote('');\n    setOverallGrnNotes('');\n    setLoadedPOHeader(null);\n    setGrnItems([]);\n    fetchInitialData();\n  };\n\n  const handlePOSelectionChange = async (poId: string) => {\n    setSelectedPOId(poId);\n    setLoadedPOHeader(null);\n    setGrnItems([]);\n    setErrorMessages(prev => ({ ...prev, general: undefined }));\n\n    if (!poId) return;\n\n    const selectedFullPO = approvedPOsForSelect.find(p => p.id.toString() === poId);\n    if (!selectedFullPO) return;\n\n    setIsLoadingPODetails(true);\n    try {\n      // Use the endpoint that fetches full PO details for GRN\n      const response = await fetch(`/api/purchase-orders/for-grn/${encodeURIComponent(selectedFullPO.poNumber)}`);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.message || `Failed to fetch details for PO ${selectedFullPO.poNumber}`);\n      }\n      const data: { poHeader: PurchaseOrderPayload, poItems: POItemPayload[] } = await response.json();\n      setLoadedPOHeader(data.poHeader);\n      setGrnItems(\n        data.poItems.map(item => {\n          const outstanding = (item.quantity || 0) - (item.quantityReceived || 0);\n          const siteDisplay = item.siteCode || item.siteName || (item.siteId ? `Site ID ${item.siteId}` : 'N/A');\n          return {\n            ...item,\n            receiveNowQty: 0,\n            outstandingQty: outstanding < 0 ? 0 : outstanding,\n            siteDisplay: siteDisplay,\n          };\n        })\n      );\n    } catch (err: any) {\n      setErrorMessages(prev => ({ ...prev, general: err.message || 'An unexpected error occurred while fetching PO details.' }));\n      toast({ title: \"Error\", description: err.message, variant: \"destructive\" });\n    } finally {\n      setIsLoadingPODetails(false);\n    }\n  };\n\n  const handleQuantityChange = (itemId: number | undefined, receiveNowStr: string) => {\n    if (!itemId) return;\n    const receiveNowQty = parseFloat(receiveNowStr);\n\n    setGrnItems(prevItems =>\n      prevItems.map(item => {\n        if (item.id === itemId) {\n          const newReceiveNow = isNaN(receiveNowQty) || receiveNowQty < 0 ? 0 : Math.min(receiveNowQty, item.outstandingQty);\n          return { ...item, receiveNowQty: newReceiveNow };\n        }\n        return item;\n      })\n    );\n  };\n  \n  const handleReceiveAllOutstanding = (itemId: number | undefined) => {\n    if (!itemId) return;\n    setGrnItems(prevItems =>\n      prevItems.map(item => \n        item.id === itemId ? { ...item, receiveNowQty: item.outstandingQty } : item\n      )\n    );\n  };\n\n  const handleConfirmReceipt = async () => {\n    if (!grnItems.some(item => item.receiveNowQty > 0)) {\n      toast({ title: \"No Items to Receive\", description: \"Please enter quantities for items you are receiving.\", variant: \"info\" });\n      return;\n    }\n    if (!selectedPOId || !loadedPOHeader || !loadedPOHeader.id) {\n        toast({ title: \"PO Not Selected\", description: \"Please select a Purchase Order.\", variant: \"destructive\"});\n        return;\n    }\n\n    setIsSubmittingGRN(true);\n    \n    const payload: GRNPostPayload = {\n      poId: loadedPOHeader.id,\n      grnDate,\n      deliveryNoteNumber: deliveryNote,\n      overallGrnNotes,\n      receivedByUserId: MOCK_RECEIVED_BY_USER_ID,\n      items: grnItems\n        .filter(item => item.receiveNowQty > 0 && item.id !== undefined)\n        .map(item => ({\n          poItemId: item.id!,\n          quantityReceivedNow: item.receiveNowQty,\n          itemSpecificNotes: item.itemSpecificNotes,\n        })),\n    };\n\n    try {\n      const response = await fetch('/api/grn', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || errorData.details || `Failed to process GRN. Server returned ${response.status}`);\n      }\n\n      const result = await response.json();\n      toast({\n        title: \"GRN Processed Successfully!\",\n        description: `GRN ${result.grnNumber} processed for PO ${loadedPOHeader.poNumber}. PO Status is now: ${result.newPOStatus}`,\n      });\n\n      resetFormForNew(); // Reset the form for the next GRN\n      \n    } catch (error: any) {\n      toast({ title: \"Error Processing GRN\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsSubmittingGRN(false);\n    }\n  };\n\n  const supplierInfo = loadedPOHeader?.supplierDetails \n    ? `${loadedPOHeader.supplierDetails.supplierName} (${loadedPOHeader.supplierDetails.supplierCode})`\n    : loadedPOHeader?.supplierId || 'N/A';\n  \n  const totalItemsToReceive = grnItems.reduce((sum, item) => sum + item.receiveNowQty, 0);\n\n  return (\n    <Card className=\"shadow-xl hover:shadow-2xl hover:scale-[1.01] transition-all duration-300 ease-in-out\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-2xl\">Goods Received Note (GRN)</CardTitle>\n        <CardDescription>Record items received against an approved Purchase Order.</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {errorMessages.general && <p className=\"text-sm text-destructive bg-destructive/10 p-2 rounded-md\">{errorMessages.general}</p>}\n        \n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4 items-end\">\n          <div className=\"lg:col-span-2\">\n            <Label htmlFor=\"po-select-grn\">Select Purchase Order *</Label>\n            <Select \n              value={selectedPOId} \n              onValueChange={handlePOSelectionChange}\n              disabled={isLoadingPOsForSelect || isLoadingPODetails}\n            >\n              <SelectTrigger id=\"po-select-grn\" className=\"w-full\">\n                <SelectValue placeholder={isLoadingPOsForSelect ? \"Loading POs...\" : \"Choose a PO to receive against\"} />\n              </SelectTrigger>\n              <SelectContent>\n                {approvedPOsForSelect.length === 0 && !isLoadingPOsForSelect && (\n                  <div className=\"p-2 text-sm text-muted-foreground\">No approved POs found for GRN.</div>\n                )}\n                {approvedPOsForSelect.map(po => (\n                  <SelectItem key={po.id} value={po.id.toString()}>\n                    {po.poNumber} - {po.supplierName} ({format(new Date(po.creationDate), 'dd MMM yyyy')})\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            {errorMessages.poSelect && <p className=\"text-xs text-destructive mt-1\">{errorMessages.poSelect}</p>}\n          </div>\n\n          <div>\n            <Label htmlFor=\"grn-date\">GRN Date *</Label>\n            <Input id=\"grn-date\" type=\"date\" value={grnDate} onChange={e => setGrnDate(e.target.value)} />\n          </div>\n        </div>\n\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          <div>\n            <Label htmlFor=\"supplier-info\">Supplier</Label>\n            <Input id=\"supplier-info\" value={loadedPOHeader ? supplierInfo : 'N/A'} readOnly className=\"bg-muted/50\" />\n          </div>\n          <div>\n            <Label htmlFor=\"delivery-note\">Supplier Delivery Note No.</Label>\n            <Input id=\"delivery-note\" placeholder=\"Enter delivery note/invoice ref\" value={deliveryNote} onChange={e => setDeliveryNote(e.target.value)} />\n          </div>\n        </div>\n\n        {isLoadingPODetails && (\n          <div className=\"flex justify-center items-center py-10\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary mr-2\" />\n            <span>Loading PO items...</span>\n          </div>\n        )}\n\n        {grnItems.length > 0 && loadedPOHeader && (\n          <div className=\"space-y-4 mt-6\">\n            <h3 className=\"text-lg font-medium font-headline\">Items for PO: {loadedPOHeader.poNumber}</h3>\n            <div className=\"rounded-md border max-h-[400px] overflow-y-auto\">\n              <Table>\n                <TableHeader className=\"sticky top-0 bg-background shadow-sm\">\n                  <TableRow>\n                    <TableHead className=\"w-[200px]\">Description</TableHead>\n                    <TableHead className=\"w-[100px]\">Site</TableHead>\n                    <TableHead className=\"text-center w-[80px]\">UOM</TableHead>\n                    <TableHead className=\"text-right w-[80px]\">Ordered</TableHead>\n                    <TableHead className=\"text-right w-[100px]\">Prev. Rec.</TableHead>\n                    <TableHead className=\"text-right w-[100px]\">Outstanding</TableHead>\n                    <TableHead className=\"w-[120px] text-center\">Receive Now *</TableHead>\n                    <TableHead className=\"w-[80px]\"></TableHead> \n                    <TableHead className=\"w-[150px]\">Item Notes</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {grnItems.map((item) => (\n                    <TableRow key={item.id}>\n                      <TableCell className=\"py-2\">{item.description}</TableCell>\n                      <TableCell className=\"py-2 text-xs\">{item.siteDisplay}</TableCell>\n                      <TableCell className=\"text-center py-2\">{item.uom}</TableCell>\n                      <TableCell className=\"text-right py-2\">{item.quantity}</TableCell>\n                      <TableCell className=\"text-right py-2\">{item.quantityReceived || 0}</TableCell>\n                      <TableCell className=\"text-right py-2 font-medium\">{item.outstandingQty}</TableCell>\n                      <TableCell className=\"text-right py-2\">\n                        <Input \n                          type=\"number\" \n                          value={item.receiveNowQty} \n                          onChange={(e) => handleQuantityChange(item.id, e.target.value)} \n                          className=\"h-8 text-right w-full\"\n                          disabled={item.outstandingQty <= 0}\n                          min=\"0\"\n                        />\n                      </TableCell>\n                       <TableCell className=\"text-center py-2\">\n                        {item.outstandingQty > 0 && (\n                            <Button\n                            type=\"button\"\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"h-8 px-2 text-xs\"\n                            onClick={() => handleReceiveAllOutstanding(item.id)}\n                            title=\"Receive all outstanding for this item\"\n                            >\n                            All\n                            </Button>\n                        )}\n                      </TableCell>\n                       <TableCell className=\"py-2\">\n                        <Input \n                          placeholder=\"Batch, remarks...\" \n                          value={item.itemSpecificNotes || ''}\n                          onChange={(e) => setGrnItems(prev => prev.map(i => i.id === item.id ? {...i, itemSpecificNotes: e.target.value} : i))}\n                          className=\"h-8 text-xs\"\n                        />\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n             <div className=\"mt-4\">\n                <Label htmlFor=\"overall-grn-notes\">Overall GRN Notes</Label>\n                <Textarea id=\"overall-grn-notes\" placeholder=\"Any general comments about this delivery...\" value={overallGrnNotes} onChange={e => setOverallGrnNotes(e.target.value)} />\n            </div>\n          </div>\n        )}\n         {selectedPOId && !isLoadingPODetails && grnItems.length === 0 && (\n            <div className=\"text-center py-6 text-muted-foreground\">\n                <FileSearch className=\"mx-auto h-10 w-10 mb-2\" />\n                <p>No items found for the selected PO, or all items have been fully received.</p>\n            </div>\n        )}\n      </CardContent>\n      <CardFooter className=\"flex justify-between items-center\">\n        <Button onClick={resetFormForNew} variant=\"outline\"><FilePlus className=\"mr-2 h-4 w-4\"/> Start New GRN</Button>\n        <Button \n            onClick={handleConfirmReceipt} \n            disabled={isSubmittingGRN || isLoadingPODetails || grnItems.length === 0 || totalItemsToReceive === 0 || !selectedPOId}\n            size=\"lg\"\n        >\n          {isSubmittingGRN ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <CheckSquare className=\"mr-2 h-4 w-4\" />}\n          Confirm Receipt ({totalItemsToReceive} items)\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4033, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/quotes/quote-form.tsx"],"sourcesContent":["\n'use client';\n\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { Button } from '@/components/ui/button';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Separator } from '@/components/ui/separator';\nimport { PlusCircle, Trash2, Save, Eye, Loader2, Edit, Search } from 'lucide-react';\nimport type { Client, QuoteItem, QuotePayload, Approver } from '@/types';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useRouter } from 'next/navigation';\nimport { format, parseISO } from 'date-fns';\n\nconst defaultItem: Omit<QuoteItem, 'quoteId'> = { id: '', partNumber: '', customerRef: '', description: '', quantity: 1, unitPrice: 0.00 };\n\ninterface QuoteFormValues {\n  clientId: string | null;\n  clientNameDisplay: string;\n  clientEmailDisplay: string;\n  quoteDate: string;\n  quoteNumberDisplay: string;\n  currency: string;\n  termsAndConditions: string;\n  notes: string;\n  items: Omit<QuoteItem, 'quoteId'>[];\n  approverId: string | null;\n  approvalDate?: string | null | undefined; // Added for completeness in form state\n}\n\nconst MOCK_CREATOR_EMAIL = 'creator@jachris.com';\nconst NO_APPROVER_VALUE = \"__none__\";\n\ninterface QuoteFormProps {\n  quoteIdToEditProp?: string | null;\n}\n\nexport function QuoteForm({ quoteIdToEditProp }: QuoteFormProps) {\n  const { toast } = useToast();\n  const router = useRouter();\n  const [subTotal, setSubTotal] = useState(0);\n  const [vatAmount, setVatAmount] = useState(0);\n  const [grandTotal, setGrandTotal] = useState(0);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isLoadingInitialData, setIsLoadingInitialData] = useState(true);\n  const [isLoadingQuoteForEdit, setIsLoadingQuoteForEdit] = useState(false);\n\n  const [isEditingLoadedQuote, setIsEditingLoadedQuote] = useState(false);\n  const [loadedQuoteId, setLoadedQuoteId] = useState<string | null>(null);\n\n  const [clients, setClients] = useState<Client[]>([]);\n  const [approvers, setApprovers] = useState<Approver[]>([]);\n\n  const form = useForm<QuoteFormValues>({\n    defaultValues: {\n      clientId: null,\n      clientNameDisplay: '',\n      clientEmailDisplay: '',\n      quoteDate: format(new Date(), 'yyyy-MM-dd'),\n      quoteNumberDisplay: 'Loading Q...',\n      currency: 'MZN',\n      termsAndConditions: 'Standard Payment Terms: 30 days. Prices valid for 15 days.',\n      notes: '',\n      items: [{...defaultItem, id: crypto.randomUUID()}],\n      approverId: null,\n    },\n    mode: 'onBlur',\n  });\n\n  const { fields, append, remove } = useFieldArray({\n    control: form.control,\n    name: 'items',\n  });\n\n  const loadQuoteDataIntoForm = useCallback((data: QuotePayload, currentClients: Client[]) => {\n    form.reset({\n      clientId: data.clientId,\n      clientNameDisplay: data.clientName || '',\n      clientEmailDisplay: data.clientEmail || '',\n      quoteDate: data.quoteDate ? format(parseISO(data.quoteDate), 'yyyy-MM-dd') : format(new Date(), 'yyyy-MM-dd'),\n      quoteNumberDisplay: data.quoteNumber,\n      currency: data.currency,\n      termsAndConditions: data.termsAndConditions || 'Standard Payment Terms: 30 days. Prices valid for 15 days.',\n      notes: data.notes || '',\n      items: (data.items || []).map(item => ({\n        ...defaultItem,\n        ...item,\n        id: item.id || crypto.randomUUID(),\n      })),\n      approverId: data.approverId || null,\n      approvalDate: data.approvalDate ? format(parseISO(data.approvalDate), 'yyyy-MM-dd') : null,\n    });\n\n    const selectedClient = currentClients.find(c => c.id === data.clientId);\n    if (selectedClient) {\n        form.setValue('clientNameDisplay', selectedClient.name);\n        form.setValue('clientEmailDisplay', selectedClient.email || '');\n    }\n\n    setIsEditingLoadedQuote(true);\n    setLoadedQuoteId(data.id || null);\n  }, [form]);\n  \n  const resetFormForNew = useCallback(async (fetchNextNumber = true) => {\n    form.reset({\n      clientId: null, clientNameDisplay: '', clientEmailDisplay: '',\n      quoteDate: format(new Date(), 'yyyy-MM-dd'),\n      quoteNumberDisplay: fetchNextNumber ? 'Fetching...' : form.getValues('quoteNumberDisplay'),\n      currency: 'MZN',\n      termsAndConditions: 'Standard Payment Terms: 30 days. Prices valid for 15 days.',\n      notes: '', items: [{...defaultItem, id: crypto.randomUUID()}],\n      approverId: null,\n    });\n    setIsEditingLoadedQuote(false);\n    setLoadedQuoteId(null);\n    if (fetchNextNumber) {\n      try {\n        const response = await fetch('/api/quotes/next-quote-number');\n        if (!response.ok) throw new Error('Failed to fetch next quote number');\n        const data = await response.json();\n        form.setValue('quoteNumberDisplay', data.nextQuoteNumber || 'Q-ERROR');\n      } catch (error) {\n        form.setValue('quoteNumberDisplay', 'Q-ERROR');\n        toast({ title: \"Error\", description: \"Could not load next quote number.\", variant: \"destructive\" });\n      }\n    }\n  }, [form, toast]);\n\n  useEffect(() => {\n    const fetchCoreDataAndInitializeForm = async () => {\n      setIsLoadingInitialData(true);\n      let fetchedClients: Client[] = [];\n      try {\n        const [clientsRes, approversRes] = await Promise.all([\n          fetch('/api/clients'),\n          fetch('/api/approvers')\n        ]);\n\n        fetchedClients = clientsRes.ok ? await clientsRes.json() : [];\n        const fetchedApprovers: Approver[] = approversRes.ok ? await approversRes.json() : [];\n        \n        setClients(fetchedClients);\n        setApprovers(fetchedApprovers);\n\n        if (quoteIdToEditProp) {\n          setIsLoadingQuoteForEdit(true);\n          const quoteRes = await fetch(`/api/quotes/${quoteIdToEditProp}`);\n          if (!quoteRes.ok) throw new Error(`Failed to fetch Quote ${quoteIdToEditProp}`);\n          const quoteDataToEdit: QuotePayload = await quoteRes.json();\n          loadQuoteDataIntoForm(quoteDataToEdit, fetchedClients);\n          setIsLoadingQuoteForEdit(false);\n        } else {\n          await resetFormForNew();\n        }\n      } catch (error) {\n        toast({ title: \"Error Loading Data\", description: `Failed to load initial form data: ${error instanceof Error ? error.message : String(error)}`, variant: \"destructive\" });\n        if (!quoteIdToEditProp) form.setValue('quoteNumberDisplay', 'Q-ERROR');\n      } finally {\n        setIsLoadingInitialData(false);\n      }\n    };\n    fetchCoreDataAndInitializeForm();\n  }, [quoteIdToEditProp, toast, loadQuoteDataIntoForm, resetFormForNew]);\n\n  const watchedItems = form.watch('items');\n  const watchedCurrency = form.watch('currency');\n\n  useEffect(() => {\n    const items = watchedItems || [];\n    let calculatedInputSum = 0;\n    items.forEach((item: Omit<QuoteItem, 'quoteId'>) => {\n        const quantity = Number(item.quantity) || 0;\n        const unitPrice = Number(item.unitPrice) || 0;\n        calculatedInputSum += quantity * unitPrice;\n    });\n\n    let newDisplaySubTotal = calculatedInputSum;\n    let newDisplayVatAmount = 0;\n    if (watchedCurrency === 'MZN') {\n        newDisplayVatAmount = newDisplaySubTotal * 0.16;\n    }\n    setSubTotal(parseFloat(newDisplaySubTotal.toFixed(2)));\n    setVatAmount(parseFloat(newDisplayVatAmount.toFixed(2)));\n    setGrandTotal(parseFloat((newDisplaySubTotal + newDisplayVatAmount).toFixed(2)));\n  }, [watchedItems, watchedCurrency]);\n\n  const handleClientChange = (selectedClientId: string | null) => {\n    const selectedClient = clients.find(c => c.id === selectedClientId);\n    if (selectedClient) {\n      form.setValue('clientId', selectedClient.id);\n      form.setValue('clientNameDisplay', selectedClient.name);\n      form.setValue('clientEmailDisplay', selectedClient.email || '');\n    } else {\n      form.setValue('clientId', null);\n      form.setValue('clientNameDisplay', '');\n      form.setValue('clientEmailDisplay', '');\n    }\n  };\n  \n  const handleLoadQuoteForEditing = async () => {\n    const quoteNumberToLoad = form.getValues('quoteNumberDisplay');\n    if (!quoteNumberToLoad || ['Loading Q...', 'Fetching...', 'Q-ERROR'].includes(quoteNumberToLoad)) {\n      toast({ title: \"Quote Number Required\", description: \"Please enter a Quote number to load.\", variant: \"destructive\" });\n      return;\n    }\n    setIsLoadingQuoteForEdit(true);\n    try {\n      const idRes = await fetch(`/api/quotes/get-by-quote-number/${encodeURIComponent(quoteNumberToLoad)}`);\n      if (!idRes.ok) {\n        const errorData = await idRes.json().catch(() => ({}));\n        throw new Error(errorData.error || `Quote Number ${quoteNumberToLoad} not found.`);\n      }\n      const { id: foundQuoteId } = await idRes.json();\n\n      if (!foundQuoteId) throw new Error(`Quote Number ${quoteNumberToLoad} not found.`);\n\n      const quoteDataRes = await fetch(`/api/quotes/${foundQuoteId}`);\n      if (!quoteDataRes.ok) throw new Error(`Failed to fetch details for Quote ID ${foundQuoteId}.`);\n      const quoteDataToLoad: QuotePayload = await quoteDataRes.json();\n      \n      // Check if editable (e.g., Draft or Pending Approval)\n      if (quoteDataToLoad.status !== 'Draft' && quoteDataToLoad.status !== 'Pending Approval') {\n          toast({ title: \"Cannot Edit\", description: `Quote ${quoteNumberToLoad} is in '${quoteDataToLoad.status}' status and cannot be edited here. View it from the list.`, variant: \"destructive\"});\n          setIsLoadingQuoteForEdit(false);\n          return;\n      }\n\n      loadQuoteDataIntoForm(quoteDataToLoad, clients);\n      toast({ title: \"Quote Loaded\", description: `Quote ${quoteNumberToLoad} loaded for editing.` });\n    } catch (error) {\n      toast({ title: \"Error Loading Quote\", description: `${error instanceof Error ? error.message : String(error)}`, variant: \"destructive\" });\n    } finally {\n      setIsLoadingQuoteForEdit(false);\n    }\n  };\n\n\n  const onSubmitAndPreview = async (formData: QuoteFormValues) => {\n    if (!formData.clientId) {\n      toast({ title: \"Validation Error\", description: \"Please select a client.\", variant: \"destructive\" });\n      return;\n    }\n    if (!formData.items || formData.items.length === 0) {\n      toast({ title: \"Validation Error\", description: \"Please add at least one item to the quote.\", variant: \"destructive\" });\n      return;\n    }\n    setIsSubmitting(true);\n    \n    const generatedQuoteId = isEditingLoadedQuote && loadedQuoteId ? loadedQuoteId : crypto.randomUUID();\n    const quoteStatus = (formData.approverId && formData.approverId !== NO_APPROVER_VALUE) ? 'Pending Approval' : 'Draft';\n    \n    const payload: QuotePayload = {\n      id: generatedQuoteId, \n      quoteNumber: formData.quoteNumberDisplay,\n      quoteDate: new Date(formData.quoteDate).toISOString(),\n      clientId: formData.clientId,\n      creatorEmail: MOCK_CREATOR_EMAIL,\n      subTotal: subTotal,\n      vatAmount: vatAmount,\n      grandTotal: grandTotal,\n      currency: formData.currency,\n      termsAndConditions: formData.termsAndConditions,\n      notes: formData.notes,\n      items: formData.items.map(item => ({\n        id: item.id || crypto.randomUUID(), \n        partNumber: item.partNumber,\n        customerRef: item.customerRef,\n        description: item.description,\n        quantity: Number(item.quantity),\n        unitPrice: Number(item.unitPrice),\n      })),\n      status: quoteStatus,\n      approverId: (formData.approverId && formData.approverId !== NO_APPROVER_VALUE) ? formData.approverId : null,\n      approvalDate: isEditingLoadedQuote ? formData.approvalDate : undefined, \n    };\n\n    try {\n      let response;\n      let successMessage = '';\n      const url = isEditingLoadedQuote && loadedQuoteId ? `/api/quotes/${loadedQuoteId}` : '/api/quotes';\n      const method = isEditingLoadedQuote && loadedQuoteId ? 'PUT' : 'POST';\n\n      response = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      const result = await response.json(); \n\n      if (!response.ok) {\n        const errorDetail = result.error || result.details || result.message || `Server error: ${response.status}`;\n        throw new Error(errorDetail);\n      }\n\n      successMessage = `Quote ${payload.quoteNumber} ${isEditingLoadedQuote ? 'updated' : 'saved'} successfully with status: ${payload.status}. Navigating to preview.`;\n      toast({ title: 'Success!', description: successMessage });\n      \n      const finalQuoteId = method === 'POST' ? result.quoteId : loadedQuoteId;\n      if (finalQuoteId) {\n        router.push(`/quotes/${finalQuoteId}/print`); \n      } else {\n        // If new, reset form\n        await resetFormForNew();\n      }\n\n    } catch (error: any) {\n      console.error(\"Error saving quote (frontend):\", error);\n      toast({ \n        title: `Error ${isEditingLoadedQuote ? 'Updating' : 'Saving'} Quote`, \n        description: error.message || 'An unexpected error occurred.', \n        variant: \"destructive\" \n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const currencySymbol = watchedCurrency === 'MZN' ? 'MZN' : (watchedCurrency === 'USD' ? '$' : watchedCurrency);\n  const formatValue = (value: number) => value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  \n  if (isLoadingInitialData && !quoteIdToEditProp) {\n    return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading form data...</div>;\n  }\n  if (isLoadingQuoteForEdit && quoteIdToEditProp) {\n     return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading Quote for editing...</div>;\n  }\n\n  return (\n    <Card className=\"w-full max-w-5xl mx-auto shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-2xl\">\n          {isEditingLoadedQuote ? `Edit Quotation: ${form.getValues('quoteNumberDisplay')}` : 'Create New Client Quotation'}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"pt-6\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmitAndPreview)} className=\"space-y-8\">\n\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <FormField\n                control={form.control} name=\"clientId\" rules={{ required: 'Client is required' }}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Client *</FormLabel>\n                    <Select onValueChange={(value) => { field.onChange(value); handleClientChange(value); }} value={field.value || ''}>\n                      <FormControl><SelectTrigger><SelectValue placeholder=\"Select a client\" /></SelectTrigger></FormControl>\n                      <SelectContent>{clients.map(c => (<SelectItem key={c.id} value={c.id}>{c.name} ({c.id})</SelectItem>))}</SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                  control={form.control} name=\"quoteNumberDisplay\" rules={{ required: 'Quote Number is required' }}\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Quote Number</FormLabel>\n                       <div className=\"flex gap-2\">\n                        <FormControl>\n                          <Input placeholder=\"Quote Number or type to load\" {...field} readOnly={isEditingLoadedQuote} />\n                        </FormControl>\n                        {!isEditingLoadedQuote && (\n                           <Button type=\"button\" variant=\"outline\" onClick={handleLoadQuoteForEditing} disabled={isLoadingQuoteForEdit} className=\"shrink-0\">\n                            {isLoadingQuoteForEdit ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Search className=\"h-4 w-4\" />} Load\n                           </Button>\n                        )}\n                      </div>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              <FormField control={form.control} name=\"quoteDate\" rules={{ required: 'Quote Date is required' }} render={({ field }) => ( <FormItem> <FormLabel>Quote Date *</FormLabel> <FormControl><Input type=\"date\" {...field} /></FormControl> <FormMessage /> </FormItem> )} />\n            </div>\n\n            <div className=\"grid md:grid-cols-2 gap-4\">\n                <FormField control={form.control} name=\"currency\" render={({ field }) => (\n                  <FormItem className=\"w-full\">\n                    <FormLabel>Currency *</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value || 'MZN'}>\n                      <FormControl><SelectTrigger><SelectValue placeholder=\"Select currency\" /></SelectTrigger></FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"MZN\">MZN</SelectItem>\n                        <SelectItem value=\"USD\">USD</SelectItem>\n                        <SelectItem value=\"ZAR\">ZAR</SelectItem>\n                        <SelectItem value=\"EUR\">EUR</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )} />\n                 <FormField\n                  control={form.control} name=\"approverId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Assign Approver (Optional)</FormLabel>\n                      <Select\n                        onValueChange={(selectedValue) => {\n                          field.onChange(selectedValue === NO_APPROVER_VALUE ? null : selectedValue);\n                        }}\n                        value={field.value || NO_APPROVER_VALUE}\n                      >\n                        <FormControl><SelectTrigger><SelectValue placeholder=\"Select an approver\" /></SelectTrigger></FormControl>\n                        <SelectContent>\n                          <SelectItem value={NO_APPROVER_VALUE}>None (Save as Draft)</SelectItem>\n                          {approvers.map(appr => (<SelectItem key={appr.id} value={appr.id}>{appr.name}</SelectItem>))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n            </div>\n\n            <Separator />\n            <h3 className=\"text-lg font-medium font-headline\">Quotation Items</h3>\n            {fields.map((itemField, index) => {\n              const itemQuantity = form.watch(`items.${index}.quantity`) || 0;\n              const itemUnitPrice = form.watch(`items.${index}.unitPrice`) || 0;\n              const itemTotal = (Number(itemQuantity) * Number(itemUnitPrice));\n              return (\n                <Card key={itemField.id} className=\"p-4 space-y-4 relative mb-4 shadow-sm\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-12 gap-x-4 gap-y-2 items-end\">\n                    <FormField control={form.control} name={`items.${index}.partNumber`} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Part Number</FormLabel>\n                        <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl>\n                      </FormItem>\n                    )} />\n                     <FormField control={form.control} name={`items.${index}.customerRef`} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Customer Ref</FormLabel>\n                        <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl>\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.description`} rules={{ required: 'Description is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-3\">\n                        <FormLabel>Description *</FormLabel>\n                        <FormControl><Input placeholder=\"Service or item description\" {...field} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.quantity`} rules={{ required: 'Quantity is required', min: { value: 1, message: 'Must be at least 1' } }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Quantity *</FormLabel>\n                        <FormControl><Input type=\"number\" placeholder=\"0\" {...field} onChange={e => field.onChange(parseFloat(e.target.value) || 0)} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.unitPrice`} rules={{ required: 'Unit Price is required', min: { value: 0.01, message: 'Must be positive' } }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Unit Price ({currencySymbol}) *</FormLabel>\n                        <FormControl><Input type=\"number\" step=\"0.01\" placeholder=\"0.00\" {...field} onChange={e => field.onChange(parseFloat(e.target.value) || 0.00)} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormItem className=\"lg:col-span-2\">\n                      <FormLabel>Item Total ({currencySymbol})</FormLabel>\n                      <div className=\"h-10 w-full rounded-md border border-input bg-muted/30 px-3 py-2 text-sm text-muted-foreground flex items-center\">{formatValue(itemTotal)}</div>\n                    </FormItem>\n                  </div>\n                  <Button type=\"button\" variant=\"destructive\" size=\"icon\" onClick={() => remove(index)} className=\"absolute top-2 right-2\" title=\"Remove Item\"><Trash2 className=\"h-4 w-4\" /></Button>\n                </Card>\n              );\n            })}\n            <Button type=\"button\" variant=\"outline\" onClick={() => append({...defaultItem, id: crypto.randomUUID() })} className=\"mt-0\"><PlusCircle className=\"mr-2 h-4 w-4\" /> Add Item</Button>\n\n            <Separator className=\"my-6\"/>\n\n            <div className=\"grid md:grid-cols-3 gap-6 mt-8 items-start\">\n              <div className=\"md:col-span-1 space-y-4\">\n                <FormField\n                  control={form.control} name=\"termsAndConditions\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Terms & Conditions</FormLabel>\n                      <FormControl>\n                        <Textarea placeholder=\"Enter terms and conditions...\" className=\"resize-none h-24\" {...field} value={field.value ?? ''} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control} name=\"notes\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Additional Notes</FormLabel>\n                      <FormControl>\n                        <Textarea placeholder=\"Add any relevant notes for the client...\" className=\"resize-none h-24\" {...field} value={field.value ?? ''} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"md:col-span-1 space-y-2 text-left border p-4 rounded-md bg-muted/20\">\n                <div className=\"text-md\">Subtotal ({currencySymbol}): <span className=\"font-semibold\">{formatValue(subTotal)}</span></div>\n                {currencySymbol === 'MZN' && <div className=\"text-md\">VAT (16%) ({currencySymbol}): <span className=\"font-semibold\">{formatValue(vatAmount)}</span></div>}\n                <div className=\"text-xl font-bold font-headline\">Grand Total ({currencySymbol}): <span className=\"font-semibold\">{formatValue(grandTotal)}</span></div>\n              </div>\n\n              <div className=\"md:col-span-1 flex flex-col gap-3 w-full pt-6\">\n                <Button type=\"submit\" size=\"lg\" className=\"w-full\" disabled={isSubmitting || !form.formState.isValid || isLoadingInitialData || isLoadingQuoteForEdit}>\n                  {isSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : (isEditingLoadedQuote ? <Edit className=\"mr-2 h-4 w-4\" /> : <Eye className=\"mr-2 h-4 w-4\" />)}\n                  {isSubmitting ? (isEditingLoadedQuote ? 'Updating...' : 'Saving...') : (isEditingLoadedQuote ? 'Update & Preview Quote' : 'Save & Preview Quote')}\n                </Button>\n                 {!isEditingLoadedQuote && (\n                  <Button type=\"button\" variant=\"ghost\" size=\"lg\" className=\"w-full\" onClick={() => resetFormForNew(false)} disabled={isSubmitting || isLoadingInitialData || isLoadingQuoteForEdit}>\n                    Clear / New Quote\n                  </Button>\n                )}\n              </div>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n      <CardFooter>\n        <p className=\"text-xs text-muted-foreground\">\n         {isEditingLoadedQuote\n            ? `Editing Quote: ${form.getValues('quoteNumberDisplay')}. Quote Number is read-only.`\n            : \"Enter Quote details. Use 'Load' for existing editable Quotes or create a new one. Select an approver to submit for approval, or leave blank to save as Draft.\"}\n        </p>\n      </CardFooter>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5515, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/requisitions/requisition-form.tsx"],"sourcesContent":["\n'use client';\n\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { Button } from '@/components/ui/button';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Separator } from '@/components/ui/separator';\nimport { PlusCircle, Trash2, Save, Eye, Loader2, Edit } from 'lucide-react';\nimport type { Site, Category as CategoryType, RequisitionItem, RequisitionPayload, User, Approver } from '@/types';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useRouter, useSearchParams } from 'next/navigation'; // Added useSearchParams\nimport { format, parseISO } from 'date-fns';\nimport { randomUUID } from 'crypto';\n\nconst defaultItem: Omit<RequisitionItem, 'requisitionId' | 'categoryName'> = { \n  id: '', \n  partNumber: '', \n  description: '', \n  categoryId: null, \n  quantity: 1, \n  justification: '',\n};\n\ninterface RequisitionFormValues {\n  requestedByUserId: string | null;\n  requestedByNameDisplay: string;\n  siteId: string | null; \n  requisitionDate: string;\n  requisitionNumberDisplay: string;\n  items: Omit<RequisitionItem, 'requisitionId' | 'categoryName'>[];\n  approverId: string | null; \n}\n\nconst MOCK_LOGGED_IN_USER_ID = 'user_005'; \nconst MOCK_LOGGED_IN_USER_NAME = 'Gil Lunguze';\nconst NO_APPROVER_VALUE = \"__none__\";\n\ninterface RequisitionFormProps {\n  requisitionIdToEditProp?: string | null;\n}\n\nexport function RequisitionForm({ requisitionIdToEditProp }: RequisitionFormProps) {\n  const { toast } = useToast();\n  const router = useRouter();\n  const searchParams = useSearchParams(); // For reading query params\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isLoadingInitialData, setIsLoadingInitialData] = useState(true);\n  const [isLoadingRequisitionForEdit, setIsLoadingRequisitionForEdit] = useState(false);\n  const [isEditingLoadedRequisition, setIsEditingLoadedRequisition] = useState(false);\n  const [loadedRequisitionId, setLoadedRequisitionId] = useState<string | null>(null);\n\n\n  const [sites, setSites] = useState<Site[]>([]);\n  const [categories, setCategories] = useState<CategoryType[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [approvers, setApprovers] = useState<Approver[]>([]);\n\n  const form = useForm<RequisitionFormValues>({\n    defaultValues: {\n      requestedByUserId: MOCK_LOGGED_IN_USER_ID,\n      requestedByNameDisplay: MOCK_LOGGED_IN_USER_NAME,\n      siteId: null, \n      requisitionDate: format(new Date(), 'yyyy-MM-dd'),\n      requisitionNumberDisplay: 'Loading REQ...',\n      items: [{...defaultItem, id: crypto.randomUUID()}],\n      approverId: null,\n    },\n    mode: 'onBlur',\n  });\n\n  const { fields, append, remove, replace } = useFieldArray({\n    control: form.control,\n    name: 'items',\n  });\n\n  const loadRequisitionDataIntoForm = useCallback((data: RequisitionPayload) => {\n    form.reset({\n      requestedByUserId: data.requestedByUserId || null,\n      requestedByNameDisplay: data.requestedByName || data.requestorFullName || '',\n      siteId: data.siteId ? data.siteId.toString() : null,\n      requisitionDate: data.requisitionDate ? format(parseISO(data.requisitionDate), 'yyyy-MM-dd') : format(new Date(), 'yyyy-MM-dd'),\n      requisitionNumberDisplay: data.requisitionNumber,\n      items: (data.items || []).map(item => ({\n        id: item.id || crypto.randomUUID(),\n        partNumber: item.partNumber || '',\n        description: item.description,\n        categoryId: item.categoryId,\n        quantity: item.quantity,\n        justification: item.justification || '',\n      })),\n      approverId: data.approverId || null,\n    });\n    setIsEditingLoadedRequisition(true);\n    setLoadedRequisitionId(data.id || null);\n  }, [form]);\n\n  const resetFormForNew = useCallback(async (fetchNextNumber = true) => {\n    form.reset({\n      requestedByUserId: MOCK_LOGGED_IN_USER_ID,\n      requestedByNameDisplay: MOCK_LOGGED_IN_USER_NAME,\n      siteId: null,\n      requisitionDate: format(new Date(), 'yyyy-MM-dd'),\n      requisitionNumberDisplay: fetchNextNumber ? 'Fetching...' : form.getValues('requisitionNumberDisplay'),\n      items: [{...defaultItem, id: crypto.randomUUID()}],\n      approverId: null,\n    });\n    setIsEditingLoadedRequisition(false);\n    setLoadedRequisitionId(null);\n    if (fetchNextNumber) {\n      try {\n        const response = await fetch('/api/requisitions/next-requisition-number');\n        if (!response.ok) throw new Error('Failed to fetch next requisition number');\n        const data = await response.json();\n        form.setValue('requisitionNumberDisplay', data.nextRequisitionNumber || 'REQ-ERROR');\n      } catch (error) {\n        form.setValue('requisitionNumberDisplay', 'REQ-ERROR');\n        toast({ title: \"Error\", description: \"Could not load next requisition number.\", variant: \"destructive\" });\n      }\n    }\n  }, [form, toast]);\n\n  useEffect(() => {\n    const reqIdFromUrl = searchParams.get('editRequisitionId') || requisitionIdToEditProp;\n\n    const fetchCoreDataAndInitializeForm = async () => {\n      setIsLoadingInitialData(true);\n      try {\n        const [sitesRes, categoriesRes, usersRes, approversRes] = await Promise.all([\n          fetch('/api/sites'),\n          fetch('/api/categories'),\n          fetch('/api/users'),\n          fetch('/api/approvers'),\n        ]);\n\n        if (sitesRes.ok) setSites(await sitesRes.json());\n        else toast({ title: \"Error\", description: \"Could not load sites.\", variant: \"destructive\" });\n        if (categoriesRes.ok) setCategories(await categoriesRes.json());\n        else toast({ title: \"Error\", description: \"Could not load categories.\", variant: \"destructive\" });\n        if (usersRes.ok) {\n          const fetchedUsers: User[] = await usersRes.json();\n          setUsers(fetchedUsers);\n          if (!reqIdFromUrl) { // Only set default user if not editing\n            const defaultUser = fetchedUsers.find(u => u.id === MOCK_LOGGED_IN_USER_ID);\n            if (defaultUser) {\n                form.setValue('requestedByUserId', defaultUser.id);\n                form.setValue('requestedByNameDisplay', defaultUser.name);\n            } else if (fetchedUsers.length > 0) { \n                form.setValue('requestedByUserId', fetchedUsers[0].id);\n                form.setValue('requestedByNameDisplay', fetchedUsers[0].name);\n            }\n          }\n        } else toast({ title: \"Error\", description: \"Could not load users.\", variant: \"destructive\" });\n        if (approversRes.ok) setApprovers(await approversRes.json());\n        else toast({ title: \"Error\", description: \"Could not load approvers.\", variant: \"destructive\" });\n\n        if (reqIdFromUrl) {\n          setIsLoadingRequisitionForEdit(true);\n          const requisitionRes = await fetch(`/api/requisitions/${reqIdFromUrl}`);\n          if (!requisitionRes.ok) {\n            const errorData = await requisitionRes.json().catch(() => ({}));\n            throw new Error(errorData.error || `Failed to fetch Requisition ${reqIdFromUrl}`);\n          }\n          const requisitionDataToEdit: RequisitionPayload = await requisitionRes.json();\n          loadRequisitionDataIntoForm(requisitionDataToEdit);\n          setIsLoadingRequisitionForEdit(false);\n        } else {\n          await resetFormForNew();\n        }\n\n      } catch (error) {\n        toast({ title: \"Error Loading Data\", description: `Failed to load initial form data: ${error instanceof Error ? error.message : String(error)}`, variant: \"destructive\" });\n        if (!reqIdFromUrl) form.setValue('requisitionNumberDisplay', 'REQ-ERROR');\n      } finally {\n        setIsLoadingInitialData(false);\n      }\n    };\n    fetchCoreDataAndInitializeForm();\n  }, [requisitionIdToEditProp, searchParams, toast, loadRequisitionDataIntoForm, resetFormForNew, form]);\n\n\n  const handleRequestorChange = (userId: string | null) => {\n    const selectedUser = users.find(u => u.id === userId);\n    form.setValue('requestedByNameDisplay', selectedUser ? selectedUser.name : 'N/A (User ID if not found)');\n    form.setValue('requestedByUserId', userId);\n  };\n\n  const onSubmitAndPreview = async (formData: RequisitionFormValues) => {\n    if (!formData.items || formData.items.length === 0) {\n      toast({ title: \"Validation Error\", description: \"Please add at least one item to the requisition.\", variant: \"destructive\" });\n      return;\n    }\n    if (!formData.requestedByUserId) {\n      toast({ title: \"Validation Error\", description: \"Please select a requestor.\", variant: \"destructive\" });\n      return;\n    }\n    if (!formData.siteId) { \n        toast({ title: \"Validation Error\", description: \"Please select a Site/Department for the requisition.\", variant: \"destructive\" });\n        return;\n    }\n    \n    setIsSubmitting(true);\n\n    const currentStatus = isEditingLoadedRequisition \n      ? (await (await fetch(`/api/requisitions/${loadedRequisitionId}`)).json() as RequisitionPayload).status // Fetch current status if editing\n      : 'Draft';\n\n    let newStatusForPayload: RequisitionPayload['status'];\n    if (isEditingLoadedRequisition && currentStatus === 'Rejected') {\n      // If editing a rejected requisition and an approver is selected, move to Pending Approval\n      newStatusForPayload = (formData.approverId && formData.approverId !== NO_APPROVER_VALUE) ? 'Pending Approval' : 'Draft';\n    } else {\n      newStatusForPayload = (formData.approverId && formData.approverId !== NO_APPROVER_VALUE) ? 'Pending Approval' : 'Draft';\n    }\n    \n    const payloadId = isEditingLoadedRequisition && loadedRequisitionId ? loadedRequisitionId : crypto.randomUUID();\n\n    const payload: Partial<RequisitionPayload> & { items: RequisitionItem[] } = {\n      id: payloadId,\n      requisitionNumber: formData.requisitionNumberDisplay,\n      requisitionDate: new Date(formData.requisitionDate).toISOString(),\n      requestedByUserId: formData.requestedByUserId,\n      requestedByName: formData.requestedByNameDisplay,\n      siteId: Number(formData.siteId), \n      status: newStatusForPayload,\n      approverId: (formData.approverId && formData.approverId !== NO_APPROVER_VALUE) ? formData.approverId : null,\n      items: formData.items.map(item => ({\n        id: item.id || crypto.randomUUID(),\n        partNumber: item.partNumber,\n        description: item.description,\n        categoryId: item.categoryId ? Number(item.categoryId) : null,\n        quantity: Number(item.quantity),\n        justification: item.justification, \n      })),\n    };\n    \n    const url = isEditingLoadedRequisition && loadedRequisitionId ? `/api/requisitions/${loadedRequisitionId}` : '/api/requisitions';\n    const method = isEditingLoadedRequisition && loadedRequisitionId ? 'PUT' : 'POST';\n\n    try {\n      const response = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ \n            error: `Failed to ${method === 'PUT' ? 'update' : 'save'} requisition. Server error.`, \n            details: 'Could not parse error response from server.' \n        }));\n        \n        let detailedMessage = errorData.error || `Server error: ${response.status}`;\n        if (errorData.details) detailedMessage += ` Details: ${errorData.details}`;\n        if (errorData.code) detailedMessage += ` Code: ${errorData.code}`;\n        throw new Error(detailedMessage);\n      }\n\n      const result = await response.json();\n      const successMessage = method === 'PUT' \n        ? `Requisition ${result.requisitionNumber || payload.requisitionNumber} updated to status: ${result.status || payload.status}.`\n        : `Requisition ${result.requisitionNumber} (Status: ${result.status}) has been saved with ID ${result.requisitionId}.`;\n      \n      toast({ title: `Requisition ${method === 'PUT' ? 'Updated' : 'Saved'}`, description: successMessage });\n      \n      const finalRequisitionId = method === 'PUT' ? loadedRequisitionId : result.requisitionId;\n      if (finalRequisitionId) {\n        router.push(`/requisitions/${finalRequisitionId}/print`);\n      } else {\n        await resetFormForNew();\n      }\n      \n    } catch (error: any) {\n      toast({ \n        title: `Error ${method === 'PUT' ? 'Updating' : 'Saving'} Requisition`, \n        description: error.message || 'An unexpected error occurred.', \n        variant: \"destructive\" \n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  \n  if (isLoadingInitialData && !requisitionIdToEditProp && !searchParams.get('editRequisitionId')) {\n    return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading form data...</div>;\n  }\n  if (isLoadingRequisitionForEdit && (requisitionIdToEditProp || searchParams.get('editRequisitionId'))) {\n     return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading Requisition for editing...</div>;\n  }\n\n  return (\n    <Card className=\"w-full max-w-5xl mx-auto shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-2xl\">\n         {isEditingLoadedRequisition ? `Edit Requisition: ${form.getValues('requisitionNumberDisplay')}` : 'Create New Purchase Requisition'}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"pt-6\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmitAndPreview)} className=\"space-y-8\">\n            <div className=\"grid md:grid-cols-3 lg:grid-cols-5 gap-4 items-end\">\n              <FormField control={form.control} name=\"requisitionNumberDisplay\" render={({ field }) => ( <FormItem className=\"lg:col-span-1\"> <FormLabel>Requisition No.</FormLabel> <FormControl><Input {...field} readOnly /></FormControl> <FormMessage /> </FormItem> )} />\n              <FormField control={form.control} name=\"requisitionDate\" rules={{ required: 'Date is required' }} render={({ field }) => ( <FormItem className=\"lg:col-span-1\"> <FormLabel>Date *</FormLabel> <FormControl><Input type=\"date\" {...field} /></FormControl> <FormMessage /> </FormItem> )} />\n              <FormField \n                control={form.control} name=\"requestedByUserId\" rules={{ required: 'Requested By is required' }}\n                render={({ field }) => ( \n                <FormItem className=\"lg:col-span-1\"> \n                  <FormLabel>Requested By *</FormLabel> \n                  <Select onValueChange={(value) => { field.onChange(value); handleRequestorChange(value); }} value={field.value || ''}>\n                      <FormControl><SelectTrigger><SelectValue placeholder=\"Select Requestor\" /></SelectTrigger></FormControl>\n                      <SelectContent>{users.map(u => (<SelectItem key={u.id} value={u.id}>{u.name} ({u.email || u.role})</SelectItem>))}</SelectContent>\n                  </Select>\n                  <FormMessage /> \n                </FormItem> \n              )} />\n              <FormField \n                control={form.control} name=\"siteId\" rules={{ required: 'Site/Department is required' }}\n                render={({ field }) => ( \n                <FormItem className=\"lg:col-span-1\"> \n                  <FormLabel>Site/Department *</FormLabel> \n                  <Select onValueChange={field.onChange} value={field.value || ''}>\n                      <FormControl><SelectTrigger><SelectValue placeholder=\"Select Site\" /></SelectTrigger></FormControl>\n                      <SelectContent>{sites.map(s => (<SelectItem key={s.id} value={s.id.toString()}>{s.siteCode || s.name}</SelectItem>))}</SelectContent>\n                  </Select>\n                  <FormMessage /> \n                </FormItem> \n              )} />\n              <FormField\n                  control={form.control} name=\"approverId\"\n                  render={({ field }) => (\n                    <FormItem className=\"lg:col-span-1\">\n                      <FormLabel>Assign Approver</FormLabel>\n                      <Select\n                        onValueChange={(selectedValue) => {\n                          field.onChange(selectedValue === NO_APPROVER_VALUE ? null : selectedValue);\n                        }}\n                        value={field.value || NO_APPROVER_VALUE}\n                      >\n                        <FormControl><SelectTrigger><SelectValue placeholder=\"Optional\" /></SelectTrigger></FormControl>\n                        <SelectContent>\n                          <SelectItem value={NO_APPROVER_VALUE}>None (Save as Draft)</SelectItem>\n                          {approvers.map(appr => (<SelectItem key={appr.id} value={appr.id}>{appr.name}</SelectItem>))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n            </div>\n            \n            <Separator />\n            <h3 className=\"text-lg font-medium font-headline\">Requested Items</h3>\n            {fields.map((itemField, index) => {\n              return (\n                <Card key={itemField.id} className=\"p-4 space-y-4 relative mb-4 shadow-sm\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-12 gap-x-4 gap-y-2 items-end\">\n                    <FormField control={form.control} name={`items.${index}.partNumber`} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Part Number</FormLabel>\n                        <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl>\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.description`} rules={{ required: 'Description is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-4\">\n                        <FormLabel>Description *</FormLabel>\n                        <FormControl><Input placeholder=\"Item or service description\" {...field} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                     <FormField control={form.control} name={`items.${index}.categoryId`} rules={{ required: 'Category is required' }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-2\">\n                        <FormLabel>Category *</FormLabel>\n                        <Select onValueChange={(v) => field.onChange(v ? Number(v) : null)} value={field.value?.toString() || ''}>\n                          <FormControl><SelectTrigger><SelectValue placeholder=\"Select\" /></SelectTrigger></FormControl>\n                          <SelectContent>{categories.map(cat => (<SelectItem key={cat.id} value={cat.id.toString()}>{cat.category}</SelectItem>))}</SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                    <FormField control={form.control} name={`items.${index}.quantity`} rules={{ required: 'Quantity is required', min: { value: 1, message: 'Must be at least 1' } }} render={({ field }) => (\n                      <FormItem className=\"lg:col-span-1\">\n                        <FormLabel>Quantity *</FormLabel>\n                        <FormControl><Input type=\"number\" placeholder=\"0\" {...field} onChange={e => field.onChange(parseFloat(e.target.value) || 0)} /></FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )} />\n                     <FormField control={form.control} name={`items.${index}.justification`} render={({ field }) => ( \n                      <FormItem className=\"lg:col-span-3\"> \n                        <FormLabel>Justification (Item Specific)</FormLabel>\n                        <FormControl><Input placeholder=\"Reason for this item\" {...field} value={field.value ?? ''} /></FormControl>\n                      </FormItem>\n                    )} />\n                  </div>\n                  <Button type=\"button\" variant=\"destructive\" size=\"icon\" onClick={() => remove(index)} className=\"absolute top-2 right-2\" title=\"Remove Item\"><Trash2 className=\"h-4 w-4\" /></Button>\n                </Card>\n              );\n            })}\n            <Button type=\"button\" variant=\"outline\" onClick={() => append({...defaultItem, id: crypto.randomUUID() })} className=\"mt-0\"><PlusCircle className=\"mr-2 h-4 w-4\" /> Add Item</Button>\n\n            <Separator className=\"my-6\"/>\n\n            <div className=\"flex justify-end items-start mt-8\">\n              <div className=\"flex flex-col gap-3 w-auto md:w-1/3\">\n                <Button type=\"submit\" size=\"lg\" className=\"w-full\" disabled={isSubmitting || !form.formState.isValid || isLoadingInitialData || isLoadingRequisitionForEdit}>\n                  {isSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : (isEditingLoadedRequisition ? <Edit className=\"mr-2 h-4 w-4\" /> : <Eye className=\"mr-2 h-4 w-4\" />)}\n                  {isSubmitting ? (isEditingLoadedRequisition ? 'Updating...' : 'Saving...') : (isEditingLoadedRequisition ? 'Update & Preview Requisition' : 'Save & Preview Requisition')}\n                </Button>\n                {!isEditingLoadedRequisition && (\n                  <Button type=\"button\" variant=\"ghost\" size=\"lg\" className=\"w-full\" onClick={() => resetFormForNew(true)} disabled={isSubmitting || isLoadingInitialData || isLoadingRequisitionForEdit}>\n                    Clear / New Requisition\n                  </Button>\n                )}\n              </div>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n      <CardFooter>\n        <p className=\"text-xs text-muted-foreground\">\n          {isEditingLoadedRequisition \n            ? `Editing Requisition: ${form.getValues('requisitionNumberDisplay')}. Requisition Number is read-only.`\n            : \"This requisition will be saved. If an approver is selected, it will be submitted for approval. Otherwise, it will be saved as a Draft.\"}\n          Site/Department is required for the overall requisition.\n        </p>\n      </CardFooter>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6716, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/fuel/fuel-record-form.tsx"],"sourcesContent":["\n'use client';\n\nimport { useForm, Controller } from 'react-hook-form';\nimport { Button } from '@/components/ui/button';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport type { Site, Tag, FuelRecord } from '@/types';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { format } from 'date-fns';\nimport { Save, Loader2 } from 'lucide-react';\nimport { randomUUID } from 'crypto';\n\ninterface FuelRecordFormValues {\n  fuelDate: string;\n  reqNo?: string;\n  invNo?: string;\n  driver?: string;\n  odometer?: number;\n  tagId: string | null;\n  siteId: string | null;\n  description?: string;\n  uom?: string;\n  quantity: number;\n  unitCost: number;\n}\n\nconst MOCK_RECORDER_USER_ID = 'user_005'; // Corrected to a valid user ID\n\nexport function FuelRecordForm() {\n  const { toast } = useToast();\n  const [totalCost, setTotalCost] = useState(0);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isLoadingInitialData, setIsLoadingInitialData] = useState(true);\n\n  const [sites, setSites] = useState<Site[]>([]);\n  const [tags, setTags] = useState<Tag[]>([]);\n\n  const form = useForm<FuelRecordFormValues>({\n    defaultValues: {\n      fuelDate: format(new Date(), 'yyyy-MM-dd'),\n      reqNo: '',\n      invNo: '',\n      driver: '',\n      odometer: undefined,\n      tagId: null,\n      siteId: null,\n      description: 'Diesel',\n      uom: 'Liters',\n      quantity: 0,\n      unitCost: 0,\n    },\n    mode: 'onBlur',\n  });\n\n  const fetchInitialData = useCallback(async () => {\n    setIsLoadingInitialData(true);\n    try {\n      const [sitesRes, tagsRes] = await Promise.all([\n        fetch('/api/sites'),\n        fetch('/api/tags')\n      ]);\n\n      if (sitesRes.ok) setSites(await sitesRes.json());\n      else toast({ title: \"Error\", description: \"Could not load sites.\", variant: \"destructive\" });\n\n      if (tagsRes.ok) setTags(await tagsRes.json());\n      else toast({ title: \"Error\", description: \"Could not load tags (vehicles/equipment).\", variant: \"destructive\" });\n\n    } catch (error) {\n      toast({ title: \"Error Loading Data\", description: \"Could not load initial form data for fuel records.\", variant: \"destructive\" });\n    } finally {\n      setIsLoadingInitialData(false);\n    }\n  }, [toast]);\n\n  useEffect(() => {\n    fetchInitialData();\n  }, [fetchInitialData]);\n\n  const watchedQuantity = form.watch('quantity');\n  const watchedUnitCost = form.watch('unitCost');\n\n  useEffect(() => {\n    const quantity = Number(watchedQuantity) || 0;\n    const unitCost = Number(watchedUnitCost) || 0;\n    setTotalCost(parseFloat((quantity * unitCost).toFixed(2)));\n  }, [watchedQuantity, watchedUnitCost]);\n\n  const onSubmit = async (formData: FuelRecordFormValues) => {\n    setIsSubmitting(true);\n\n    const payload: Omit<FuelRecord, 'id' | 'tagName' | 'siteName' | 'totalCost' | 'distanceTravelled'> & { recorderUserId?: string } = {\n      fuelDate: new Date(formData.fuelDate).toISOString(),\n      reqNo: formData.reqNo,\n      invNo: formData.invNo,\n      driver: formData.driver,\n      odometer: formData.odometer ? Number(formData.odometer) : undefined,\n      tagId: formData.tagId!,\n      siteId: formData.siteId ? Number(formData.siteId) : null,\n      description: formData.description,\n      uom: formData.uom,\n      quantity: Number(formData.quantity),\n      unitCost: Number(formData.unitCost),\n      recorderUserId: MOCK_RECORDER_USER_ID,\n    };\n\n    try {\n      const response = await fetch('/api/fuel-records', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: 'Failed to save fuel record. Server error.' }));\n        throw new Error(errorData.error || `Server error: ${response.status}`);\n      }\n\n      const result = await response.json();\n      toast({ title: 'Fuel Record Saved', description: `Fuel record ID ${result.fuelRecordId} has been saved successfully.` });\n      form.reset();\n      setTotalCost(0);\n\n    } catch (error: any) {\n      toast({ title: 'Error Saving Fuel Record', description: error.message || 'An unexpected error occurred.', variant: \"destructive\" });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const formatValue = (value: number) => value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  \n  if (isLoadingInitialData) {\n    return <div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading form data...</div>;\n  }\n\n  return (\n    <Card className=\"w-full max-w-4xl mx-auto shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-2xl\">Record Fuel Consumption</CardTitle>\n      </CardHeader>\n      <CardContent className=\"pt-6\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <FormField control={form.control} name=\"fuelDate\" rules={{ required: 'Date is required' }} render={({ field }) => ( <FormItem> <FormLabel>Date</FormLabel> <FormControl><Input type=\"date\" {...field} /></FormControl> <FormMessage /> </FormItem> )} />\n              <FormField\n                control={form.control}\n                name=\"tagId\"\n                rules={{ required: 'Tag (Vehicle/Equipment) is required' }}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Tag (Vehicle/Equipment)</FormLabel>\n                    <Select\n                      onValueChange={(selectedTagId) => {\n                        field.onChange(selectedTagId); // Update the form state for tagId\n                        const selectedTag = tags.find(t => t.id === selectedTagId);\n                        if (selectedTag && selectedTag.siteId) {\n                          form.setValue('siteId', selectedTag.siteId.toString());\n                        } else {\n                          form.setValue('siteId', null); // Reset site if tag has no assigned site\n                        }\n                      }}\n                      value={field.value || ''}\n                    >\n                      <FormControl>\n                        <SelectTrigger><SelectValue placeholder=\"Select Tag\" /></SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {tags.map(t => (\n                          <SelectItem key={t.id} value={t.id}>{t.tagNumber}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"siteId\"\n                rules={{ required: 'Site is required' }}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Site</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value || ''}>\n                      <FormControl>\n                        <SelectTrigger><SelectValue placeholder=\"Select Site\" /></SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {sites.map(s => (\n                          <SelectItem key={s.id} value={s.id.toString()}>\n                            {s.name} ({s.siteCode})\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <FormField control={form.control} name=\"driver\" render={({ field }) => ( <FormItem> <FormLabel>Driver</FormLabel> <FormControl><Input placeholder=\"Driver's name\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n              <FormField control={form.control} name=\"odometer\" render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Odometer (km)</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"e.g., 123456\"\n                      {...field}\n                      value={field.value ?? ''}\n                      onChange={e => field.onChange(parseFloat(e.target.value) || undefined)}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )} />\n              <FormField control={form.control} name=\"reqNo\" render={({ field }) => ( <FormItem> <FormLabel>Requisition No.</FormLabel> <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n            </div>\n\n            <div className=\"grid md:grid-cols-3 gap-4\">\n                <FormField control={form.control} name=\"invNo\" render={({ field }) => ( <FormItem> <FormLabel>Invoice No.</FormLabel> <FormControl><Input placeholder=\"Optional\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"description\" render={({ field }) => ( <FormItem> <FormLabel>Description</FormLabel> <FormControl><Input placeholder=\"e.g., Diesel, Petrol\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n                <FormField control={form.control} name=\"uom\" rules={{ required: \"UOM is required\"}} render={({ field }) => ( <FormItem> <FormLabel>UOM</FormLabel> <FormControl><Input placeholder=\"e.g., Liters, Gal\" {...field} value={field.value ?? ''} /></FormControl> <FormMessage /> </FormItem> )} />\n            </div>\n\n            <div className=\"grid md:grid-cols-3 gap-4 items-end\">\n              <FormField control={form.control} name=\"quantity\" rules={{ required: 'Quantity is required', min: { value: 0.01, message: 'Must be > 0' } }} render={({ field }) => (\n                <FormItem> <FormLabel>Quantity</FormLabel>\n                  <FormControl><Input type=\"number\" step=\"0.01\" placeholder=\"0.00\" {...field} value={field.value ?? 0} onChange={e => field.onChange(parseFloat(e.target.value) || 0)} /></FormControl> <FormMessage />\n                </FormItem>\n              )} />\n              <FormField control={form.control} name=\"unitCost\" rules={{ required: 'Unit Cost is required', min: { value: 0.01, message: 'Must be > 0' } }} render={({ field }) => (\n                <FormItem> <FormLabel>Unit Cost (MZN)</FormLabel>\n                  <FormControl><Input type=\"number\" step=\"0.01\" placeholder=\"0.00\" {...field} value={field.value ?? 0} onChange={e => field.onChange(parseFloat(e.target.value) || 0.00)} /></FormControl> <FormMessage />\n                </FormItem>\n              )} />\n              <FormItem>\n                <FormLabel>Total Cost (MZN)</FormLabel>\n                <div className=\"h-10 w-full rounded-md border border-input bg-muted/30 px-3 py-2 text-sm text-muted-foreground flex items-center\">{formatValue(totalCost)}</div>\n              </FormItem>\n            </div>\n\n            <div className=\"flex justify-end pt-4\">\n              <Button type=\"submit\" size=\"lg\" disabled={isSubmitting || !form.formState.isValid || isLoadingInitialData}>\n                {isSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Save className=\"mr-2 h-4 w-4\" />}\n                {isSubmitting ? 'Saving...' : 'Save Fuel Record'}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n      <CardFooter>\n        <p className=\"text-xs text-muted-foreground\">\n          Ensure all fuel consumption details are accurate. Data is now saved directly to the database.\n        </p>\n      </CardFooter>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7665, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAGhC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,6KAAA,CAAA,OAAwB;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;0BAET,6LAAC,6KAAA,CAAA,WAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,6LAAC;;;;;0BACD,6LAAC,6KAAA,CAAA,SAA0B;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,6KAAA,CAAA,OAAwB,CAAC,WAAW;AAE7D,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,6LAAC,6KAAA,CAAA,sBAAuC;QACtC,KAAK;QACL,aAAa;QACb,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,6KAAA,CAAA,kBAAmC;YAAC,WAAU;;;;;;;;;;;MAjB7C;AAoBN,UAAU,WAAW,GAAG,6KAAA,CAAA,sBAAuC,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 7742, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/shared/data-table.tsx"],"sourcesContent":["\n'use client';\n\nimport * as React from 'react';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { ScrollArea } from '@/components/ui/scroll-area';\n\n// A simplified column definition type for this basic table\nexport interface ColumnDef<TData> {\n  accessorKey: keyof TData | string; // For direct data access\n  header: React.ReactNode;\n  cell?: (row: TData) => React.ReactNode; // For custom cell rendering\n}\n\ninterface DataTableProps<TData> {\n  columns: ColumnDef<TData>[];\n  data: TData[];\n  // Optional prop to render action buttons for each row\n  renderRowActions?: (row: TData) => React.ReactNode;\n}\n\nexport function DataTable<TData>({\n  columns,\n  data,\n  renderRowActions,\n}: DataTableProps<TData>) {\n  return (\n    <ScrollArea className=\"rounded-md border\">\n      <Table>\n        <TableHeader className=\"sticky top-0 bg-background z-10 shadow-sm\">\n          <TableRow>\n            {columns.map((column, index) => (\n              <TableHead key={index}>{column.header}</TableHead>\n            ))}\n            {renderRowActions && <TableHead className=\"text-right\">Actions</TableHead>}\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {data.length > 0 ? (\n            data.map((row, rowIndex) => (\n              <TableRow key={rowIndex}>\n                {columns.map((column, colIndex) => (\n                  <TableCell key={colIndex}>\n                    {column.cell\n                      ? column.cell(row)\n                      : String((row as any)[column.accessorKey] ?? '')}\n                  </TableCell>\n                ))}\n                {renderRowActions && (\n                  <TableCell className=\"text-right\">\n                    {renderRowActions(row)}\n                  </TableCell>\n                )}\n              </TableRow>\n            ))\n          ) : (\n            <TableRow>\n              <TableCell\n                colSpan={columns.length + (renderRowActions ? 1 : 0)}\n                className=\"h-24 text-center\"\n              >\n                No results found.\n              </TableCell>\n            </TableRow>\n          )}\n        </TableBody>\n      </Table>\n    </ScrollArea>\n  );\n}\n"],"names":[],"mappings":";;;;AAIA;AAQA;AAXA;;;;AA2BO,SAAS,UAAiB,EAC/B,OAAO,EACP,IAAI,EACJ,gBAAgB,EACM;IACtB,qBACE,6LAAC,6IAAA,CAAA,aAAU;QAAC,WAAU;kBACpB,cAAA,6LAAC,oIAAA,CAAA,QAAK;;8BACJ,6LAAC,oIAAA,CAAA,cAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC,oIAAA,CAAA,WAAQ;;4BACN,QAAQ,GAAG,CAAC,CAAC,QAAQ,sBACpB,6LAAC,oIAAA,CAAA,YAAS;8CAAc,OAAO,MAAM;mCAArB;;;;;4BAEjB,kCAAoB,6LAAC,oIAAA,CAAA,YAAS;gCAAC,WAAU;0CAAa;;;;;;;;;;;;;;;;;8BAG3D,6LAAC,oIAAA,CAAA,YAAS;8BACP,KAAK,MAAM,GAAG,IACb,KAAK,GAAG,CAAC,CAAC,KAAK,yBACb,6LAAC,oIAAA,CAAA,WAAQ;;gCACN,QAAQ,GAAG,CAAC,CAAC,QAAQ,yBACpB,6LAAC,oIAAA,CAAA,YAAS;kDACP,OAAO,IAAI,GACR,OAAO,IAAI,CAAC,OACZ,OAAO,AAAC,GAAW,CAAC,OAAO,WAAW,CAAC,IAAI;uCAHjC;;;;;gCAMjB,kCACC,6LAAC,oIAAA,CAAA,YAAS;oCAAC,WAAU;8CAClB,iBAAiB;;;;;;;2BAVT;;;;kDAgBjB,6LAAC,oIAAA,CAAA,WAAQ;kCACP,cAAA,6LAAC,oIAAA,CAAA,YAAS;4BACR,SAAS,QAAQ,MAAM,GAAG,CAAC,mBAAmB,IAAI,CAAC;4BACnD,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf;KAhDgB","debugId":null}},
    {"offset": {"line": 7854, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/shared/filter-bar.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport type { FilterOption, Site, Approver, User, Tag } from '@/types';\nimport { Filter, Loader2 } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\nconst months: FilterOption[] = [\n  { value: '01', label: 'January' }, { value: '02', label: 'February' }, { value: '03', label: 'March' },\n  { value: '04', label: 'April' }, { value: '05', label: 'May' }, { value: '06', label: 'June' },\n  { value: '07', label: 'July' }, { value: '08', label: 'August' }, { value: '09', label: 'September' },\n  { value: '10', label: 'October' }, { value: '11', label: 'November' }, { value: '12', label: 'December' },\n];\nconst monthsWithAll: FilterOption[] = [{ value: 'all', label: 'All Months' }, ...months];\n\nconst currentYear = new Date().getFullYear();\nconst years: FilterOption[] = Array.from({ length: 10 }, (_, i) => ({\n  value: (currentYear - i).toString(),\n  label: (currentYear - i).toString(),\n}));\nconst yearsWithAll: FilterOption[] = [{ value: 'all', label: 'All Years' }, ...years];\n\ninterface FilterBarProps {\n  onFilterApply?: (filters: {\n    month?: string;\n    year?: string;\n    siteId?: string;\n    approverId?: string;\n    creatorUserId?: string;\n    tagId?: string;\n    driver?: string;\n    user?: string; // For generic user name filter (e.g., Activity Log)\n    action?: string; // For generic action type filter (e.g., Activity Log)\n    status?: string; // For status filter, e.g., Requisitions\n  }) => void;\n  showApproverFilter?: boolean;\n  showRequestorFilter?: boolean;\n  showSiteFilter?: boolean;\n  showTagFilter?: boolean;\n  showDriverFilter?: boolean;\n  showUserFilter?: boolean;\n  showActionTypeFilter?: boolean;\n  showStatusFilter?: boolean; // Added for Requisition status\n  statusOptions?: FilterOption[]; // Options for the status dropdown\n}\n\nexport function FilterBar({\n  onFilterApply,\n  showApproverFilter = false,\n  showRequestorFilter = false,\n  showSiteFilter = false,\n  showTagFilter = false,\n  showDriverFilter = false,\n  showUserFilter = false,\n  showActionTypeFilter = false,\n  showStatusFilter = false,\n  statusOptions = [],\n}: FilterBarProps) {\n  const { toast } = useToast();\n  const [isLoadingFilters, setIsLoadingFilters] = useState(false);\n\n  const [selectedMonth, setSelectedMonth] = useState<string>((new Date().getMonth() + 1).toString().padStart(2, '0'));\n  const [selectedYear, setSelectedYear] = useState<string>(new Date().getFullYear().toString());\n  \n  const [sites, setSites] = useState<FilterOption[]>([{ value: 'all', label: 'All Sites' }]);\n  const [selectedSite, setSelectedSite] = useState<string>('all');\n\n  const [approvers, setApprovers] = useState<FilterOption[]>([{ value: 'all', label: 'All Approvers' }]);\n  const [selectedApprover, setSelectedApprover] = useState<string>('all');\n\n  const [requestors, setRequestors] = useState<FilterOption[]>([{ value: 'all', label: 'All Requestors' }]);\n  const [selectedRequestor, setSelectedRequestor] = useState<string>('all');\n  \n  const [tags, setTags] = useState<FilterOption[]>([{ value: 'all', label: 'All Tags' }]);\n  const [selectedTag, setSelectedTag] = useState<string>('all');\n  \n  const [driverName, setDriverName] = useState<string>('');\n  const [userNameFilter, setUserNameFilter] = useState<string>('');\n  const [actionTypeFilterText, setActionTypeFilterText] = useState<string>(''); // Renamed from actionTypeFilter to avoid conflict with prop\n  const [selectedStatus, setSelectedStatus] = useState<string>('all');\n\n\n  const fetchFilterData = useCallback(async () => {\n    setIsLoadingFilters(true);\n    try {\n      const promises = [];\n      if (showSiteFilter) promises.push(fetch('/api/sites'));\n      else promises.push(Promise.resolve(null)); \n\n      if (showApproverFilter) promises.push(fetch('/api/approvers'));\n      else promises.push(Promise.resolve(null));\n\n      if (showRequestorFilter) promises.push(fetch('/api/users'));\n      else promises.push(Promise.resolve(null));\n\n      if (showTagFilter) promises.push(fetch('/api/tags'));\n      else promises.push(Promise.resolve(null));\n\n\n      const responses = await Promise.all(promises);\n      const data = await Promise.all(responses.map(res => res && res.ok ? res.json() : Promise.resolve([])));\n\n      if (showSiteFilter && data[0]) {\n        const siteData: Site[] = data[0];\n        setSites([{ value: 'all', label: 'All Sites' }, ...siteData.map(s => ({ value: s.id.toString(), label: `${s.siteCode || s.name} (${s.name})` }))]);\n      }\n      if (showApproverFilter && data[1]) {\n        const approverData: Approver[] = data[1];\n        setApprovers([{ value: 'all', label: 'All Approvers' }, ...approverData.map(a => ({ value: a.id, label: a.name }))]);\n      }\n      if (showRequestorFilter && data[2]) {\n        const userData: User[] = data[2];\n        setRequestors([{ value: 'all', label: 'All Requestors' }, ...userData.map(u => ({ value: u.id, label: u.name }))]);\n      }\n      if (showTagFilter && data[3]) {\n        const tagData: Tag[] = data[3];\n        setTags([{ value: 'all', label: 'All Tags' }, ...tagData.map(t => ({ value: t.id, label: `${t.tagNumber} (${t.make || ''} ${t.model || t.type || ''})`}))]);\n      }\n\n    } catch (error) {\n      toast({ title: 'Error', description: 'Could not load some filter options from server.', variant: 'destructive' });\n      console.error(\"Error fetching filter data:\", error);\n    } finally {\n      setIsLoadingFilters(false);\n    }\n  }, [toast, showSiteFilter, showApproverFilter, showRequestorFilter, showTagFilter]);\n\n  useEffect(() => {\n    fetchFilterData();\n  }, [fetchFilterData]);\n\n  const handleApplyFilters = () => {\n    onFilterApply?.({\n      month: selectedMonth,\n      year: selectedYear,\n      siteId: showSiteFilter ? selectedSite : undefined,\n      approverId: showApproverFilter ? selectedApprover : undefined,\n      creatorUserId: showRequestorFilter ? selectedRequestor : undefined,\n      tagId: showTagFilter ? selectedTag : undefined,\n      driver: showDriverFilter ? driverName : undefined,\n      user: showUserFilter ? userNameFilter : undefined,\n      action: showActionTypeFilter ? actionTypeFilterText : undefined,\n      status: showStatusFilter ? selectedStatus : undefined,\n    });\n  };\n\n  return (\n    <div className=\"mb-6 flex flex-col gap-4 rounded-lg border bg-card p-4 shadow-sm sm:flex-row sm:items-end sm:flex-wrap\">\n      <div className=\"grid flex-1 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5\">\n        <div>\n          <label htmlFor=\"month-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Month</label>\n          <Select value={selectedMonth} onValueChange={setSelectedMonth}>\n            <SelectTrigger id=\"month-filter\"><SelectValue placeholder=\"Select Month\" /></SelectTrigger>\n            <SelectContent>{monthsWithAll.map((month: FilterOption) => (<SelectItem key={month.value} value={month.value}>{month.label}</SelectItem>))}</SelectContent>\n          </Select>\n        </div>\n        <div>\n          <label htmlFor=\"year-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Year</label>\n          <Select value={selectedYear} onValueChange={setSelectedYear}>\n            <SelectTrigger id=\"year-filter\"><SelectValue placeholder=\"Select Year\" /></SelectTrigger>\n            <SelectContent>{yearsWithAll.map((year: FilterOption) => (<SelectItem key={year.value} value={year.value}>{year.label}</SelectItem>))}</SelectContent>\n          </Select>\n        </div>\n        {showSiteFilter && (\n          <div>\n            <label htmlFor=\"site-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Site</label>\n            <Select value={selectedSite} onValueChange={setSelectedSite} disabled={isLoadingFilters}>\n              <SelectTrigger id=\"site-filter\"><SelectValue placeholder={isLoadingFilters ? \"Loading sites...\" : \"Select Site\"} /></SelectTrigger>\n              <SelectContent>{sites.map((site: FilterOption) => (<SelectItem key={site.value} value={site.value}>{site.label}</SelectItem>))}</SelectContent>\n            </Select>\n          </div>\n        )}\n        {showApproverFilter && (\n          <div>\n            <label htmlFor=\"approver-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Approver</label>\n            <Select value={selectedApprover} onValueChange={setSelectedApprover} disabled={isLoadingFilters}>\n              <SelectTrigger id=\"approver-filter\"><SelectValue placeholder={isLoadingFilters ? \"Loading approvers...\" : \"Select Approver\"} /></SelectTrigger>\n              <SelectContent>{approvers.map((approver: FilterOption) => (<SelectItem key={approver.value} value={approver.value}>{approver.label}</SelectItem>))}</SelectContent>\n            </Select>\n          </div>\n        )}\n        {showRequestorFilter && (\n          <div>\n            <label htmlFor=\"requestor-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Requestor</label>\n            <Select value={selectedRequestor} onValueChange={setSelectedRequestor} disabled={isLoadingFilters}>\n              <SelectTrigger id=\"requestor-filter\"><SelectValue placeholder={isLoadingFilters ? \"Loading requestors...\" : \"Select Requestor\"} /></SelectTrigger>\n              <SelectContent>{requestors.map((requestor: FilterOption) => (<SelectItem key={requestor.value} value={requestor.value}>{requestor.label}</SelectItem>))}</SelectContent>\n            </Select>\n          </div>\n        )}\n        {showTagFilter && (\n            <div>\n                <label htmlFor=\"tag-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Tag</label>\n                <Select value={selectedTag} onValueChange={setSelectedTag} disabled={isLoadingFilters}>\n                    <SelectTrigger id=\"tag-filter\"><SelectValue placeholder={isLoadingFilters ? \"Loading tags...\" : \"Select Tag\"} /></SelectTrigger>\n                    <SelectContent>{tags.map((tag: FilterOption) => (<SelectItem key={tag.value} value={tag.value}>{tag.label}</SelectItem>))}</SelectContent>\n                </Select>\n            </div>\n        )}\n        {showDriverFilter && (\n            <div>\n                <label htmlFor=\"driver-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Driver Name</label>\n                <Input\n                    id=\"driver-filter\"\n                    placeholder=\"Enter driver name\"\n                    value={driverName}\n                    onChange={(e) => setDriverName(e.target.value)}\n                    disabled={isLoadingFilters}\n                />\n            </div>\n        )}\n        {showUserFilter && (\n          <div>\n            <label htmlFor=\"user-name-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Filter by User</label>\n            <Input\n                id=\"user-name-filter\"\n                placeholder=\"Enter user name...\"\n                value={userNameFilter}\n                onChange={(e) => setUserNameFilter(e.target.value)}\n                disabled={isLoadingFilters}\n            />\n          </div>\n        )}\n        {showActionTypeFilter && (\n          <div>\n            <label htmlFor=\"action-type-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Filter by Action</label>\n            <Input\n                id=\"action-type-filter\"\n                placeholder=\"e.g., Created, Approved...\"\n                value={actionTypeFilterText}\n                onChange={(e) => setActionTypeFilterText(e.target.value)}\n                disabled={isLoadingFilters}\n            />\n          </div>\n        )}\n        {showStatusFilter && statusOptions.length > 0 && (\n          <div>\n            <label htmlFor=\"status-filter\" className=\"mb-1 block text-sm font-medium text-card-foreground/80\">Status</label>\n            <Select value={selectedStatus} onValueChange={setSelectedStatus} disabled={isLoadingFilters}>\n              <SelectTrigger id=\"status-filter\"><SelectValue placeholder=\"Select Status\" /></SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                {statusOptions.map((option: FilterOption) => (\n                  <SelectItem key={option.value} value={option.value}>{option.label}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        )}\n      </div>\n      <Button onClick={handleApplyFilters} className=\"mt-4 sm:mt-0 sm:self-end\" disabled={isLoadingFilters}>\n        {isLoadingFilters ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\"/> : <Filter className=\"mr-2 h-4 w-4\" />}\n        Apply Filters\n      </Button>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AACA;AAEA;AAAA;AACA;;;AARA;;;;;;;AAUA,MAAM,SAAyB;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAU;IAAG;QAAE,OAAO;QAAM,OAAO;IAAW;IAAG;QAAE,OAAO;QAAM,OAAO;IAAQ;IACrG;QAAE,OAAO;QAAM,OAAO;IAAQ;IAAG;QAAE,OAAO;QAAM,OAAO;IAAM;IAAG;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7F;QAAE,OAAO;QAAM,OAAO;IAAO;IAAG;QAAE,OAAO;QAAM,OAAO;IAAS;IAAG;QAAE,OAAO;QAAM,OAAO;IAAY;IACpG;QAAE,OAAO;QAAM,OAAO;IAAU;IAAG;QAAE,OAAO;QAAM,OAAO;IAAW;IAAG;QAAE,OAAO;QAAM,OAAO;IAAW;CACzG;AACD,MAAM,gBAAgC;IAAC;QAAE,OAAO;QAAO,OAAO;IAAa;OAAM;CAAO;AAExF,MAAM,cAAc,IAAI,OAAO,WAAW;AAC1C,MAAM,QAAwB,MAAM,IAAI,CAAC;IAAE,QAAQ;AAAG,GAAG,CAAC,GAAG,IAAM,CAAC;QAClE,OAAO,CAAC,cAAc,CAAC,EAAE,QAAQ;QACjC,OAAO,CAAC,cAAc,CAAC,EAAE,QAAQ;IACnC,CAAC;AACD,MAAM,eAA+B;IAAC;QAAE,OAAO;QAAO,OAAO;IAAY;OAAM;CAAM;AA0B9E,SAAS,UAAU,EACxB,aAAa,EACb,qBAAqB,KAAK,EAC1B,sBAAsB,KAAK,EAC3B,iBAAiB,KAAK,EACtB,gBAAgB,KAAK,EACrB,mBAAmB,KAAK,EACxB,iBAAiB,KAAK,EACtB,uBAAuB,KAAK,EAC5B,mBAAmB,KAAK,EACxB,gBAAgB,EAAE,EACH;;IACf,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,+HAAA,CAAA,WAAQ,AAAD;IACzB,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEzD,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU,CAAC,IAAI,OAAO,QAAQ,KAAK,CAAC,EAAE,QAAQ,GAAG,QAAQ,CAAC,GAAG;IAC9G,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU,IAAI,OAAO,WAAW,GAAG,QAAQ;IAE1F,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;QAAC;YAAE,OAAO;YAAO,OAAO;QAAY;KAAE;IACzF,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAEzD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;QAAC;YAAE,OAAO;YAAO,OAAO;QAAgB;KAAE;IACrG,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAEjE,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;QAAC;YAAE,OAAO;YAAO,OAAO;QAAiB;KAAE;IACxG,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAEnE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;QAAC;YAAE,OAAO;YAAO,OAAO;QAAW;KAAE;IACtF,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAEvD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IACrD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAC7D,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU,KAAK,4DAA4D;IAC1I,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAG7D,MAAM,kBAAkB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;kDAAE;YAClC,oBAAoB;YACpB,IAAI;gBACF,MAAM,WAAW,EAAE;gBACnB,IAAI,gBAAgB,SAAS,IAAI,CAAC,MAAM;qBACnC,SAAS,IAAI,CAAC,QAAQ,OAAO,CAAC;gBAEnC,IAAI,oBAAoB,SAAS,IAAI,CAAC,MAAM;qBACvC,SAAS,IAAI,CAAC,QAAQ,OAAO,CAAC;gBAEnC,IAAI,qBAAqB,SAAS,IAAI,CAAC,MAAM;qBACxC,SAAS,IAAI,CAAC,QAAQ,OAAO,CAAC;gBAEnC,IAAI,eAAe,SAAS,IAAI,CAAC,MAAM;qBAClC,SAAS,IAAI,CAAC,QAAQ,OAAO,CAAC;gBAGnC,MAAM,YAAY,MAAM,QAAQ,GAAG,CAAC;gBACpC,MAAM,OAAO,MAAM,QAAQ,GAAG,CAAC,UAAU,GAAG;8DAAC,CAAA,MAAO,OAAO,IAAI,EAAE,GAAG,IAAI,IAAI,KAAK,QAAQ,OAAO,CAAC,EAAE;;gBAEnG,IAAI,kBAAkB,IAAI,CAAC,EAAE,EAAE;oBAC7B,MAAM,WAAmB,IAAI,CAAC,EAAE;oBAChC,SAAS;wBAAC;4BAAE,OAAO;4BAAO,OAAO;wBAAY;2BAAM,SAAS,GAAG;sEAAC,CAAA,IAAK,CAAC;oCAAE,OAAO,EAAE,EAAE,CAAC,QAAQ;oCAAI,OAAO,GAAG,EAAE,QAAQ,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC;gCAAC,CAAC;;qBAAG;gBACnJ;gBACA,IAAI,sBAAsB,IAAI,CAAC,EAAE,EAAE;oBACjC,MAAM,eAA2B,IAAI,CAAC,EAAE;oBACxC,aAAa;wBAAC;4BAAE,OAAO;4BAAO,OAAO;wBAAgB;2BAAM,aAAa,GAAG;sEAAC,CAAA,IAAK,CAAC;oCAAE,OAAO,EAAE,EAAE;oCAAE,OAAO,EAAE,IAAI;gCAAC,CAAC;;qBAAG;gBACrH;gBACA,IAAI,uBAAuB,IAAI,CAAC,EAAE,EAAE;oBAClC,MAAM,WAAmB,IAAI,CAAC,EAAE;oBAChC,cAAc;wBAAC;4BAAE,OAAO;4BAAO,OAAO;wBAAiB;2BAAM,SAAS,GAAG;sEAAC,CAAA,IAAK,CAAC;oCAAE,OAAO,EAAE,EAAE;oCAAE,OAAO,EAAE,IAAI;gCAAC,CAAC;;qBAAG;gBACnH;gBACA,IAAI,iBAAiB,IAAI,CAAC,EAAE,EAAE;oBAC5B,MAAM,UAAiB,IAAI,CAAC,EAAE;oBAC9B,QAAQ;wBAAC;4BAAE,OAAO;4BAAO,OAAO;wBAAW;2BAAM,QAAQ,GAAG;sEAAC,CAAA,IAAK,CAAC;oCAAE,OAAO,EAAE,EAAE;oCAAE,OAAO,GAAG,EAAE,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,IAAI,GAAG,CAAC,EAAE,EAAE,KAAK,IAAI,EAAE,IAAI,IAAI,GAAG,CAAC,CAAC;gCAAA,CAAC;;qBAAG;gBAC5J;YAEF,EAAE,OAAO,OAAO;gBACd,MAAM;oBAAE,OAAO;oBAAS,aAAa;oBAAmD,SAAS;gBAAc;gBAC/G,QAAQ,KAAK,CAAC,+BAA+B;YAC/C,SAAU;gBACR,oBAAoB;YACtB;QACF;iDAAG;QAAC;QAAO;QAAgB;QAAoB;QAAqB;KAAc;IAElF,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;+BAAE;YACR;QACF;8BAAG;QAAC;KAAgB;IAEpB,MAAM,qBAAqB;QACzB,gBAAgB;YACd,OAAO;YACP,MAAM;YACN,QAAQ,iBAAiB,eAAe;YACxC,YAAY,qBAAqB,mBAAmB;YACpD,eAAe,sBAAsB,oBAAoB;YACzD,OAAO,gBAAgB,cAAc;YACrC,QAAQ,mBAAmB,aAAa;YACxC,MAAM,iBAAiB,iBAAiB;YACxC,QAAQ,uBAAuB,uBAAuB;YACtD,QAAQ,mBAAmB,iBAAiB;QAC9C;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAe,WAAU;0CAAyD;;;;;;0CACjG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAe,eAAe;;kDAC3C,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAe,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAY;;;;;;;;;;;kDAC1D,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,cAAc,GAAG,CAAC,CAAC,sBAAyB,6LAAC,qIAAA,CAAA,aAAU;gDAAmB,OAAO,MAAM,KAAK;0DAAG,MAAM,KAAK;+CAA7C,MAAM,KAAK;;;;;;;;;;;;;;;;;;;;;;kCAG5F,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAc,WAAU;0CAAyD;;;;;;0CAChG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAc,eAAe;;kDAC1C,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAc,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAY;;;;;;;;;;;kDACzD,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,aAAa,GAAG,CAAC,CAAC,qBAAwB,6LAAC,qIAAA,CAAA,aAAU;gDAAkB,OAAO,KAAK,KAAK;0DAAG,KAAK,KAAK;+CAA1C,KAAK,KAAK;;;;;;;;;;;;;;;;;;;;;;oBAGxF,gCACC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAc,WAAU;0CAAyD;;;;;;0CAChG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAc,eAAe;gCAAiB,UAAU;;kDACrE,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAc,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAa,mBAAmB,qBAAqB;;;;;;;;;;;kDAClG,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,MAAM,GAAG,CAAC,CAAC,qBAAwB,6LAAC,qIAAA,CAAA,aAAU;gDAAkB,OAAO,KAAK,KAAK;0DAAG,KAAK,KAAK;+CAA1C,KAAK,KAAK;;;;;;;;;;;;;;;;;;;;;;oBAInF,oCACC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAkB,WAAU;0CAAyD;;;;;;0CACpG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAkB,eAAe;gCAAqB,UAAU;;kDAC7E,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAkB,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAa,mBAAmB,yBAAyB;;;;;;;;;;;kDAC1G,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,UAAU,GAAG,CAAC,CAAC,yBAA4B,6LAAC,qIAAA,CAAA,aAAU;gDAAsB,OAAO,SAAS,KAAK;0DAAG,SAAS,KAAK;+CAAtD,SAAS,KAAK;;;;;;;;;;;;;;;;;;;;;;oBAI/F,qCACC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAmB,WAAU;0CAAyD;;;;;;0CACrG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAmB,eAAe;gCAAsB,UAAU;;kDAC/E,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAmB,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAa,mBAAmB,0BAA0B;;;;;;;;;;;kDAC5G,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,WAAW,GAAG,CAAC,CAAC,0BAA6B,6LAAC,qIAAA,CAAA,aAAU;gDAAuB,OAAO,UAAU,KAAK;0DAAG,UAAU,KAAK;+CAAzD,UAAU,KAAK;;;;;;;;;;;;;;;;;;;;;;oBAIlG,+BACG,6LAAC;;0CACG,6LAAC;gCAAM,SAAQ;gCAAa,WAAU;0CAAyD;;;;;;0CAC/F,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAa,eAAe;gCAAgB,UAAU;;kDACjE,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAa,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAa,mBAAmB,oBAAoB;;;;;;;;;;;kDAChG,6LAAC,qIAAA,CAAA,gBAAa;kDAAE,KAAK,GAAG,CAAC,CAAC,oBAAuB,6LAAC,qIAAA,CAAA,aAAU;gDAAiB,OAAO,IAAI,KAAK;0DAAG,IAAI,KAAK;+CAAvC,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;oBAItF,kCACG,6LAAC;;0CACG,6LAAC;gCAAM,SAAQ;gCAAgB,WAAU;0CAAyD;;;;;;0CAClG,6LAAC,oIAAA,CAAA,QAAK;gCACF,IAAG;gCACH,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;gCAC7C,UAAU;;;;;;;;;;;;oBAIrB,gCACC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAmB,WAAU;0CAAyD;;;;;;0CACrG,6LAAC,oIAAA,CAAA,QAAK;gCACF,IAAG;gCACH,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;gCACjD,UAAU;;;;;;;;;;;;oBAIjB,sCACC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAqB,WAAU;0CAAyD;;;;;;0CACvG,6LAAC,oIAAA,CAAA,QAAK;gCACF,IAAG;gCACH,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,wBAAwB,EAAE,MAAM,CAAC,KAAK;gCACvD,UAAU;;;;;;;;;;;;oBAIjB,oBAAoB,cAAc,MAAM,GAAG,mBAC1C,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAgB,WAAU;0CAAyD;;;;;;0CAClG,6LAAC,qIAAA,CAAA,SAAM;gCAAC,OAAO;gCAAgB,eAAe;gCAAmB,UAAU;;kDACzE,6LAAC,qIAAA,CAAA,gBAAa;wCAAC,IAAG;kDAAgB,cAAA,6LAAC,qIAAA,CAAA,cAAW;4CAAC,aAAY;;;;;;;;;;;kDAC3D,6LAAC,qIAAA,CAAA,gBAAa;;0DACZ,6LAAC,qIAAA,CAAA,aAAU;gDAAC,OAAM;0DAAM;;;;;;4CACvB,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC,qIAAA,CAAA,aAAU;oDAAoB,OAAO,OAAO,KAAK;8DAAG,OAAO,KAAK;mDAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAOzC,6LAAC,qIAAA,CAAA,SAAM;gBAAC,SAAS;gBAAoB,WAAU;gBAA2B,UAAU;;oBACjF,iCAAmB,6LAAC,oNAAA,CAAA,UAAO;wBAAC,WAAU;;;;;6CAAgC,6LAAC,yMAAA,CAAA,SAAM;wBAAC,WAAU;;;;;;oBAAkB;;;;;;;;;;;;;AAKnH;GAlNgB;;QAYI,+HAAA,CAAA,WAAQ;;;KAZZ","debugId":null}},
    {"offset": {"line": 8644, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8796, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/shared/document-list-view.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { DataTable, type ColumnDef } from '@/components/shared/data-table';\nimport { FilterBar } from '@/components/shared/filter-bar';\nimport { Button } from '@/components/ui/button';\nimport { Download, Eye, Loader2, AlertTriangle, UploadCloud, Edit2, Trash2 } from 'lucide-react';\nimport type { PurchaseOrderPayload, QuotePayload, RequisitionPayload, FuelRecord } from '@/types';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { useToast } from '@/hooks/use-toast';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\nimport { format } from 'date-fns';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\n\n\ninterface DocumentListViewProps {\n  documentType: 'po' | 'grn' | 'quote' | 'requisition' | 'fuel';\n}\n\ntype DocumentData = PurchaseOrderPayload | QuotePayload | RequisitionPayload | FuelRecord;\n\nconst poColumns: ColumnDef<PurchaseOrderPayload>[] = [\n  { accessorKey: 'poNumber', header: 'PO Number' },\n  {\n    accessorKey: 'creationDate',\n    header: 'Date',\n    cell: (item) => format(new Date(item.creationDate), 'dd MMM yyyy'),\n  },\n  {\n    accessorKey: 'status',\n    header: 'Status',\n  },\n  {\n    accessorKey: 'supplierName',\n    header: 'Supplier',\n    cell: (item) => item.supplierName || item.supplierId || 'N/A',\n  },\n  {\n    accessorKey: 'grandTotal',\n    header: 'Total',\n    cell: (item) => `${item.currency} ${item.grandTotal.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`,\n  },\n  {\n    accessorKey: 'requestedByName',\n    header: 'Requestor',\n    cell: (item) => item.requestedByName || item.creatorName || 'N/A',\n  },\n  {\n    accessorKey: 'approverName',\n    header: 'Approver',\n    cell: (item) => item.approverName || item.approverId || 'N/A',\n  },\n  {\n    accessorKey: 'overallSiteName',\n    header: 'Site',\n    cell: (item) => item.overallSiteName || 'N/A'\n  },\n];\n\nconst quoteColumns: ColumnDef<QuotePayload>[] = [\n  { accessorKey: 'quoteNumber', header: 'Quote Number' },\n  {\n    accessorKey: 'quoteDate',\n    header: 'Date',\n    cell: (item) => format(new Date(item.quoteDate), 'dd MMM yyyy')\n  },\n  {\n    accessorKey: 'clientName',\n    header: 'Client',\n    cell: (item) => item.clientName || item.clientId || 'N/A'\n  },\n  {\n    accessorKey: 'grandTotal',\n    header: 'Total',\n    cell: (item) => `${item.currency} ${item.grandTotal.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`\n  },\n  { accessorKey: 'status', header: 'Status' },\n];\n\nconst requisitionColumns: ColumnDef<RequisitionPayload>[] = [\n  { accessorKey: 'requisitionNumber', header: 'Requisition No.'},\n  {\n    accessorKey: 'requisitionDate',\n    header: 'Date',\n    cell: (item) => format(new Date(item.requisitionDate), 'dd MMM yyyy')\n  },\n  { accessorKey: 'requestedByName', header: 'Requested By' },\n  {\n    accessorKey: 'siteName',\n    header: 'Site Code',\n    cell: (item) => item.siteName || (item.siteId ? `Site ID: ${item.siteId}` : 'N/A')\n  },\n  { accessorKey: 'status', header: 'Status' },\n  {\n    accessorKey: 'totalEstimatedValue',\n    header: 'Est. Value',\n    cell: (item) => item.totalEstimatedValue ? `${item.totalEstimatedValue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })} MZN` : 'N/A'\n  },\n];\n\nconst fuelRecordColumns: ColumnDef<FuelRecord>[] = [\n    { accessorKey: 'fuelDate', header: 'Date', cell: (item) => format(new Date(item.fuelDate), 'dd MMM yyyy') },\n    { accessorKey: 'driver', header: 'Driver' },\n    { accessorKey: 'tagName', header: 'Tag' },\n    { accessorKey: 'siteName', header: 'Site Code' },\n    { accessorKey: 'quantity', header: 'Qty', cell: (item) => `${item.quantity} ${item.uom || ''}` },\n    { accessorKey: 'unitCost', header: 'Unit Cost (MZN)', cell: (item) => item.unitCost.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) },\n    { accessorKey: 'totalCost', header: 'Total Cost (MZN)', cell: (item) => (item.totalCost || (item.quantity * item.unitCost)).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) },\n    { accessorKey: 'odometer', header: 'Odometer (km)' },\n    {\n      accessorKey: 'distanceTravelled',\n      header: 'Distance (km)',\n      cell: (item) => item.distanceTravelled !== null && item.distanceTravelled !== undefined ? item.distanceTravelled.toLocaleString() : 'N/A'\n    },\n];\n\n\nexport function DocumentListView({ documentType }: DocumentListViewProps) {\n  const [documents, setDocuments] = useState<DocumentData[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { toast } = useToast();\n  const router = useRouter();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isUploading, setIsUploading] = useState(false);\n\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [documentToDelete, setDocumentToDelete] = useState<DocumentData | null>(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const API_BASE_URLS = {\n    po: '/api/purchase-orders',\n    quote: '/api/quotes',\n    requisition: '/api/requisitions',\n    fuel: '/api/fuel-records',\n    grn: '/api/grn'\n  };\n\n  const fetchDocuments = useCallback(async (filters?: any) => {\n    const apiUrlBase = API_BASE_URLS[documentType];\n    if (!apiUrlBase || documentType === 'grn') { // GRN list view not implemented yet\n      setError(`List view for ${documentType.toUpperCase()}s is not configured or available.`);\n      setDocuments([]);\n      setIsLoading(false);\n      return;\n    }\n\n    const queryParams = new URLSearchParams();\n    const defaultMonth = (new Date().getMonth() + 1).toString().padStart(2, '0');\n    const defaultYear = new Date().getFullYear().toString();\n\n    queryParams.append('month', (filters?.month && filters.month !== 'all') ? filters.month : defaultMonth);\n    queryParams.append('year', (filters?.year && filters.year !== 'all') ? filters.year : defaultYear);\n\n    if (filters?.siteId && filters.siteId !== 'all') queryParams.append('siteId', filters.siteId);\n    if (filters?.approverId && filters.approverId !== 'all') queryParams.append('approverId', filters.approverId);\n    if (filters?.creatorUserId && filters.creatorUserId !== 'all') queryParams.append('creatorUserId', filters.creatorUserId); // Ensure this matches FilterBar's output for requestor\n    if (filters?.tagId && filters.tagId !== 'all') queryParams.append('tagId', filters.tagId);\n    if (filters?.driver && filters.driver.trim() !== '') queryParams.append('driver', filters.driver);\n    if (documentType === 'requisition' && filters?.status && filters.status !== 'all') queryParams.append('status', filters.status);\n\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`${apiUrlBase}?${queryParams.toString()}`);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        const errorMessage = errorData.details || errorData.error || `Failed to fetch ${documentType.toUpperCase()}s.`;\n        throw new Error(errorMessage);\n      }\n      const data: DocumentData[] = await response.json();\n      setDocuments(data);\n    } catch (err: any) {\n      console.error(`Error fetching ${documentType}s:`, err);\n      setError(err.message || `An unexpected error occurred while fetching ${documentType.toUpperCase()}s.`);\n      toast({ title: `Error Fetching ${documentType.toUpperCase()}s`, description: err.message, variant: \"destructive\"});\n    } finally {\n      setIsLoading(false);\n    }\n  }, [documentType, toast]);\n\n  useEffect(() => {\n    if (documentType !== 'grn') { // Don't fetch for GRN list view\n        fetchDocuments();\n    }\n  }, [fetchDocuments, documentType]);\n\n  const handleFilterApply = (filters: any) => {\n     const apiFilters = {\n        month: filters.month,\n        year: filters.year,\n        siteId: filters.site, // FilterBar uses 'site'\n        approverId: filters.approver, // FilterBar uses 'approver'\n        creatorUserId: filters.requestor, // FilterBar uses 'requestor'\n        tagId: filters.tag, // FilterBar uses 'tag'\n        driver: filters.driver,\n        status: documentType === 'requisition' ? filters.status : undefined,\n    };\n    fetchDocuments(apiFilters);\n  };\n\n  const handleDownloadExcel = () => {\n    toast({ title: \"Feature Not Implemented\", description: `Download to Excel for ${documentType.toUpperCase()} list is not yet available.`});\n  };\n\n  const handleUploadCsvClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setIsUploading(true);\n    const formData = new FormData();\n    formData.append('file', file);\n\n    const uploadUrl = API_BASE_URLS[documentType];\n    if (!uploadUrl || documentType === 'grn' || documentType === 'fuel' || documentType === 'requisition') { // GRN, Fuel, Req CSV upload not supported here\n        toast({ title: \"Upload Error\", description: `CSV Upload not supported for ${documentType.toUpperCase()}s via this interface.`, variant: \"destructive\"});\n        setIsUploading(false);\n        return;\n    }\n\n    try {\n        const response = await fetch(uploadUrl, { method: 'POST', body: formData });\n        const result = await response.json();\n        if (!response.ok) throw new Error(result.error || result.message || 'File upload failed.');\n\n        toast({ title: \"Upload Processing\", description: result.message || \"File processed.\" });\n        if (result.errors && result.errors.length > 0) {\n            result.errors.forEach((errMsg: string) => {\n                toast({ title: \"Upload Warning\", description: errMsg, variant: \"destructive\", duration: 7000 });\n            });\n        }\n        fetchDocuments();\n    } catch (error: any) {\n        toast({ title: \"Upload Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n        setIsUploading(false);\n        if (fileInputRef.current) fileInputRef.current.value = '';\n    }\n  };\n\n  const openDeleteDialog = (doc: DocumentData) => {\n    setDocumentToDelete(doc);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const confirmDelete = async () => {\n    if (!documentToDelete || !documentToDelete.id) return;\n    setIsDeleting(true);\n\n    const deleteUrl = `${API_BASE_URLS[documentType]}/${documentToDelete.id}`;\n\n    try {\n      const response = await fetch(deleteUrl, { method: 'DELETE' });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `Failed to delete ${documentType}.`);\n      }\n      toast({ title: \"Success\", description: `${documentType.toUpperCase()} ${documentToDelete.id} deleted successfully.` });\n      fetchDocuments();\n    } catch (error: any) {\n      toast({ title: `Error Deleting ${documentType.toUpperCase()}`, description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsDeleting(false);\n      setIsDeleteDialogOpen(false);\n      setDocumentToDelete(null);\n    }\n  };\n\n  const renderRowActions = (doc: DocumentData) => {\n    const docId = doc.id;\n    let printPath = '';\n    let editPath = '';\n    let canDelete = false;\n    let currentStatus: string | undefined = undefined;\n\n    if (documentType === 'po' && docId) {\n      currentStatus = (doc as PurchaseOrderPayload).status;\n      printPath = `/purchase-orders/${docId}/print`;\n      if (currentStatus === 'Draft' || currentStatus === 'Pending Approval' || currentStatus === 'Rejected') {\n          editPath = `/create-document?editPoId=${docId}`;\n      }\n       if (currentStatus === 'Draft' || currentStatus === 'Rejected') {\n          canDelete = true;\n      }\n    } else if (documentType === 'quote' && docId) {\n      currentStatus = (doc as QuotePayload).status;\n      printPath = `/quotes/${docId}/print`;\n      if (currentStatus === 'Draft' || currentStatus === 'Pending Approval') {\n        editPath = `/create-document?editQuoteId=${docId}`;\n      }\n      if (currentStatus === 'Draft' || currentStatus === 'Rejected') {\n        canDelete = true;\n      }\n    } else if (documentType === 'requisition' && docId) {\n      currentStatus = (doc as RequisitionPayload).status;\n      printPath = `/requisitions/${docId}/print`;\n      if (currentStatus === 'Draft' || currentStatus === 'Pending Approval' || currentStatus === 'Rejected') {\n        editPath = `/create-document?editRequisitionId=${docId}`;\n      }\n      if (currentStatus === 'Draft' || currentStatus === 'Rejected') {\n         canDelete = true;\n      }\n    }\n    // No edit/delete for fuel records or GRN list view via this general component for now\n\n    return (\n      <div className=\"space-x-1 flex justify-end\">\n        {printPath && (\n          <Link href={printPath} passHref legacyBehavior={false}>\n            <Button variant=\"outline\" size=\"sm\" title={`View ${documentType.toUpperCase()} Details`}><Eye className=\"h-4 w-4\" /></Button>\n          </Link>\n        )}\n        {editPath && (\n          <Link href={editPath} passHref legacyBehavior={false}>\n            <Button variant=\"outline\" size=\"sm\" title={`Edit ${documentType.toUpperCase()}`}><Edit2 className=\"h-4 w-4\" /></Button>\n          </Link>\n        )}\n        {canDelete && (\n            <Button variant=\"destructive\" size=\"sm\" title={`Delete ${documentType.toUpperCase()}`} onClick={() => openDeleteDialog(doc)} disabled={isDeleting}>\n                <Trash2 className=\"h-4 w-4\" />\n            </Button>\n        )}\n      </div>\n    );\n  };\n\n\n  let columnsToUse: ColumnDef<any>[] = [];\n  let listTitle = '';\n  let filterConfig = {\n    showApproverFilter: false,\n    showRequestorFilter: false,\n    showSiteFilter: false,\n    showTagFilter: false,\n    showDriverFilter: false,\n    showStatusFilter: false, // For Requisition status filter\n  };\n  let showUploadCsv = false;\n  let csvTemplateLink = '';\n\n\n  if (documentType === 'po') {\n    columnsToUse = poColumns as ColumnDef<any>[];\n    listTitle = 'Purchase Orders';\n    filterConfig = { ...filterConfig, showApproverFilter: true, showRequestorFilter: true, showSiteFilter: true };\n    showUploadCsv = true; csvTemplateLink = '/templates/purchase_orders_template.csv';\n  } else if (documentType === 'quote') {\n    columnsToUse = quoteColumns as ColumnDef<any>[];\n    listTitle = 'Client Quotations';\n    filterConfig = { ...filterConfig, showSiteFilter: false, showRequestorFilter: false };\n    showUploadCsv = true; csvTemplateLink = '/templates/quotes_template.csv';\n  } else if (documentType === 'requisition') {\n    columnsToUse = requisitionColumns as ColumnDef<any>[];\n    listTitle = 'Purchase Requisitions';\n    filterConfig = { ...filterConfig, showRequestorFilter: true, showSiteFilter: true, showStatusFilter: true };\n  } else if (documentType === 'fuel') {\n    columnsToUse = fuelRecordColumns as ColumnDef<any>[];\n    listTitle = 'Fuel Records';\n    filterConfig = { ...filterConfig, showSiteFilter: true, showRequestorFilter: false, showTagFilter: true, showDriverFilter: true };\n  } else if (documentType === 'grn') {\n    // GRN list view is not implemented via this component yet\n    listTitle = 'Goods Received Notes (List View Pending)';\n    columnsToUse = [{ accessorKey: 'grnNumber', header: 'GRN Number'}, { accessorKey: 'poNumber', header: 'PO Number'}, {accessorKey: 'date', header: 'Date'}]; // Placeholder\n  } else {\n     columnsToUse = [{ accessorKey: 'name', header: 'Name (Placeholder)' }];\n     listTitle = `${documentType.toUpperCase()}s`;\n  }\n\n  if (documentType === 'grn') {\n    return (\n        <Card className=\"shadow-lg mt-6\">\n            <CardHeader>\n                <CardTitle className=\"font-headline text-xl capitalize\">List of {listTitle}</CardTitle>\n                <CardDescription>A dedicated list view for Goods Received Notes is planned for future implementation.</CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"text-center py-10 text-muted-foreground\">\n                    <Package className=\"mx-auto h-12 w-12 mb-4\" />\n                    <p>GRN list view is currently under development.</p>\n                </div>\n            </CardContent>\n        </Card>\n    );\n  }\n\n\n  return (\n    <Card className=\"shadow-lg mt-6\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-xl capitalize\">List of {listTitle}</CardTitle>\n        <CardDescription>View, filter, and manage existing {listTitle.toLowerCase()} documents.</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <FilterBar\n          onFilterApply={handleFilterApply}\n          showApproverFilter={filterConfig.showApproverFilter}\n          showRequestorFilter={filterConfig.showRequestorFilter}\n          showSiteFilter={filterConfig.showSiteFilter}\n          showTagFilter={filterConfig.showTagFilter}\n          showDriverFilter={filterConfig.showDriverFilter}\n          showStatusFilter={filterConfig.showStatusFilter}\n          statusOptions={documentType === 'requisition' ? [\n            { value: 'Draft', label: 'Draft' },\n            { value: 'Pending Approval', label: 'Pending Approval' },\n            { value: 'Approved', label: 'Approved' },\n            { value: 'Rejected', label: 'Rejected' },\n            { value: 'Closed', label: 'Closed' },\n          ] : undefined}\n        />\n        <div className=\"mt-4 flex justify-end gap-2\">\n          {showUploadCsv && (\n            <>\n              <Button onClick={handleUploadCsvClick} variant=\"outline\" disabled={isUploading}>\n                {isUploading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <UploadCloud className=\"mr-2 h-4 w-4\" />}\n                Upload CSV\n              </Button>\n              <input type=\"file\" ref={fileInputRef} onChange={handleFileUpload} accept=\".csv\" style={{ display: 'none' }} />\n              {csvTemplateLink && (\n                <Button asChild variant=\"link\" size=\"sm\">\n                  <a href={csvTemplateLink} download>Download Template</a>\n                </Button>\n              )}\n            </>\n          )}\n        </div>\n        <div className=\"mt-4\">\n          {isLoading ? (\n             <div className=\"flex justify-center items-center h-64\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                <p className=\"ml-2 text-muted-foreground\">Loading documents...</p>\n            </div>\n          ) : error ? (\n            <div className=\"flex flex-col items-center justify-center h-64 text-destructive-foreground bg-destructive/10 p-4 rounded-md\">\n                <AlertTriangle className=\"h-8 w-8 mb-2\" />\n                <p className=\"font-semibold\">Error loading documents:</p>\n                <p className=\"text-sm text-center\">{error}</p>\n                <Button onClick={() => fetchDocuments()} variant=\"outline\" className=\"mt-4 border-destructive-foreground text-destructive-foreground hover:bg-destructive/20\">\n                    Retry\n                </Button>\n            </div>\n          ) : (\n            <DataTable\n              columns={columnsToUse}\n              data={documents}\n              renderRowActions={renderRowActions}\n            />\n          )}\n        </div>\n      </CardContent>\n       {documentToDelete && (\n        <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Confirm Deletion</AlertDialogTitle>\n              <AlertDialogDescription>\n                Are you sure you want to delete this {documentType.toUpperCase()} (ID: {documentToDelete.id})? This action cannot be undone.\n                {(documentType === 'po' && ((documentToDelete as PurchaseOrderPayload).status !== 'Draft' && (documentToDelete as PurchaseOrderPayload).status !== 'Rejected')) ||\n                 (documentType === 'quote' && ((documentToDelete as QuotePayload).status !== 'Draft' && (documentToDelete as QuotePayload).status !== 'Rejected')) ||\n                 (documentType === 'requisition' && ((documentToDelete as RequisitionPayload).status !== 'Draft' && (documentToDelete as RequisitionPayload).status !== 'Rejected')) ?\n                 <span className=\"font-bold text-destructive block mt-2\">Warning: This document is not in 'Draft' or 'Rejected' status. Deleting it may have unintended consequences.</span>\n                 : null\n                }\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel disabled={isDeleting} onClick={() => setIsDeleteDialogOpen(false)}>Cancel</AlertDialogCancel>\n              <Button onClick={confirmDelete} variant=\"destructive\" disabled={isDeleting}>\n                {isDeleting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n                Delete\n              </Button>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n      )}\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9757, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,OAAO,mKAAA,CAAA,OAAkB;AAE/B,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mKAAA,CAAA,OAAkB;QACjB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,8FACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG,mKAAA,CAAA,OAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,uYACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,mKAAA,CAAA,UAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,mIACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,mKAAA,CAAA,UAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 9823, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/create-document/page.tsx"],"sourcesContent":["\n'use client';\n\nimport { useEffect, useState, Suspense } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport { POForm } from '@/components/purchase-orders/po-form';\nimport { GRNInterface } from '@/components/receiving/grn-interface';\nimport { QuoteForm } from '@/components/quotes/quote-form';\nimport { RequisitionForm } from '@/components/requisitions/requisition-form';\nimport { FuelRecordForm } from '@/components/fuel/fuel-record-form';\nimport { DocumentListView } from '@/components/shared/document-list-view';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Loader2 } from 'lucide-react';\n\nfunction CreateDocumentContent() {\n  const searchParams = useSearchParams();\n  const poIdToEditFromUrl = searchParams.get('editPoId');\n  const quoteIdToEditFromUrl = searchParams.get('editQuoteId');\n  const requisitionIdToEditFromUrl = searchParams.get('editRequisitionId'); // New\n\n  const determineDefaultMainTab = () => {\n    if (poIdToEditFromUrl) return \"create-po\";\n    if (quoteIdToEditFromUrl) return \"create-quote\";\n    if (requisitionIdToEditFromUrl) return \"create-requisition\"; // New\n    return \"create-po\";\n  };\n\n  const defaultMainTab = determineDefaultMainTab();\n  const defaultPOTab = poIdToEditFromUrl ? \"create-po-form\" : \"create-po-form\";\n  const defaultQuoteTab = quoteIdToEditFromUrl ? \"create-quote-form\" : \"create-quote-form\";\n  const defaultRequisitionTab = requisitionIdToEditFromUrl ? \"create-requisition-form\" : \"create-requisition-form\"; // Updated\n  const defaultFuelTab = \"create-fuel-form\";\n\n\n  return (\n    <Tabs defaultValue={defaultMainTab} className=\"w-full space-y-6\">\n      <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2\">\n        <TabsTrigger value=\"create-po\">Purchase Orders</TabsTrigger>\n        <TabsTrigger value=\"create-grn\">GRNs</TabsTrigger>\n        <TabsTrigger value=\"create-quote\">Client Quotes</TabsTrigger>\n        <TabsTrigger value=\"create-requisition\">Requisitions</TabsTrigger>\n        <TabsTrigger value=\"record-fuel\">Fuel Records</TabsTrigger>\n      </TabsList>\n\n      <TabsContent value=\"create-po\">\n        <Tabs defaultValue={defaultPOTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 gap-2 mb-4\">\n            <TabsTrigger value=\"create-po-form\">\n              {poIdToEditFromUrl ? 'Edit PO' : 'Create New PO'}\n            </TabsTrigger>\n            <TabsTrigger value=\"list-pos\">List of POs</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"create-po-form\">\n            <POForm poIdToEditProp={poIdToEditFromUrl} />\n          </TabsContent>\n          <TabsContent value=\"list-pos\">\n            <DocumentListView documentType=\"po\" />\n          </TabsContent>\n        </Tabs>\n      </TabsContent>\n\n      <TabsContent value=\"create-grn\">\n        <GRNInterface />\n      </TabsContent>\n\n      <TabsContent value=\"create-quote\">\n        <Tabs defaultValue={defaultQuoteTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 gap-2 mb-4\">\n            <TabsTrigger value=\"create-quote-form\">\n              {quoteIdToEditFromUrl ? 'Edit Quote' : 'Create New Quote'}\n            </TabsTrigger>\n            <TabsTrigger value=\"list-quotes\">List of Quotes</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"create-quote-form\">\n            <QuoteForm quoteIdToEditProp={quoteIdToEditFromUrl} />\n          </TabsContent>\n          <TabsContent value=\"list-quotes\">\n            <DocumentListView documentType=\"quote\" />\n          </TabsContent>\n        </Tabs>\n      </TabsContent>\n\n      <TabsContent value=\"create-requisition\">\n        <Tabs defaultValue={defaultRequisitionTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 gap-2 mb-4\">\n            <TabsTrigger value=\"create-requisition-form\">\n              {requisitionIdToEditFromUrl ? 'Edit Requisition' : 'Create New Requisition'}\n            </TabsTrigger>\n            <TabsTrigger value=\"list-requisitions\">List of Requisitions</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"create-requisition-form\">\n             <RequisitionForm requisitionIdToEditProp={requisitionIdToEditFromUrl} />\n          </TabsContent>\n          <TabsContent value=\"list-requisitions\">\n            <DocumentListView documentType=\"requisition\" />\n          </TabsContent>\n        </Tabs>\n      </TabsContent>\n\n      <TabsContent value=\"record-fuel\">\n        <Tabs defaultValue={defaultFuelTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 gap-2 mb-4\">\n            <TabsTrigger value=\"create-fuel-form\">Record New Fuel Entry</TabsTrigger>\n            <TabsTrigger value=\"list-fuel-records\">List of Fuel Records</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"create-fuel-form\">\n             <FuelRecordForm />\n          </TabsContent>\n          <TabsContent value=\"list-fuel-records\">\n            <DocumentListView documentType=\"fuel\" />\n          </TabsContent>\n        </Tabs>\n      </TabsContent>\n    </Tabs>\n  );\n}\n\nexport default function CreateDocumentPage() {\n  return (\n    <Suspense fallback={<div className=\"flex justify-center items-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /> Loading...</div>}>\n      <CreateDocumentContent />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}